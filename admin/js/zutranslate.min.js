!function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function t(t){for(var a=1;a<arguments.length;a++){var l=null!=arguments[a]?arguments[a]:{};a%2?e(Object(l),!0).forEach((function(e){n(t,e,l[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):e(Object(l)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(l,e))}))}return t}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return r(e)||i(e,t)||c(e,t)||d()}function l(e){return o(e)||s(e)||c(e)||p()}function o(e){if(Array.isArray(e))return u(e)}function r(e){if(Array.isArray(e))return e}function s(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function i(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a=[],l=!0,o=!1,r,s;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);l=!0);}catch(e){o=!0,s=e}finally{try{l||null==n.return||n.return()}finally{if(o)throw s}}return a}}function c(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function p(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(e){var t=U("Content attributes:","zu-translate");return le("".concat(t,"`").concat(x(T(e),"` `"),"`"))}function m(e,t,n){var a=/^(?!\d)[\w$]+\/(?!\d)[\w$]+$/,l=H(P(t,",")),o=a.test(e)?null:{msg:"errName",value:A(e)?null:e};return null===o&&j(n,e)&&(o={msg:"errDups",value:e}),null===o&&0===l.length&&(o={msg:"errAtts",value:null}),{name:e,atts:l,error:o}}var h=wp.i18n.__,g=wp.zukit.utils.simpleMarkdown,f,v=(0,wp.zukit.render.externalDataSettings)("zutranslate",{}),y=v.disabled,w=v.qtxlink,k=h("This plugin only *complements* the functionality of the **qTranslate-XT** plugin.\nThe [qTranslate-XT]($link1) version `3.10 or above` should be installed and activated (now it **was not found** among active plugins).","zu-translate"),z={gutenberg:{label:h("Support WordPress Block Editor","zu-translate"),help:h('Settings and list of supported blocks see below in the "**Block Editor Support**" section.',"zu-translate")},flags:{label:h("Show flags in buttons","zu-translate"),help:h("Display country flag on language switching buttons in admin mode.","zu-translate")},appearance:{label:h("Custom button appearance","zu-translate"),help:h("Change the appearance of the buttons for language switching in admin mode.","zu-translate")},large:{label:h("Large custom button size","zu-translate"),help:h("Enlarge the size of the buttons (*for those who prefer more*).","zu-translate"),depends:"appearance"},list:{label:h('Add "Language Switcher" to post/pages list',"zu-translate"),help:h("Ability to switch language on a list of posts/pages and support for **Quick Edit**.","zu-translate")}},_={ls_frontend:{label:h("Swither on Front-End?","zu-translate"),help:h("???","zu-translate")},ls_menu:{label:h("Swither in Menu?","zu-translate"),help:h("The switcher should be added in menu to be displayed.","zu-translate")},ls_display:{label:h("Display in Menu","zu-translate"),help:h("How the language will be dispayed in menu","zu-translate")}},E={note:h("Only blocks **known to this plugin** will support language switching in the **Block Editor**.\nTo disable the block support - turn off the **checkbox** in front of the block name. You can also add other blocks - for this you need to know the **internal** name of the block (which includes the `namespace`) and the name of the attribute/attributes that contain the **content** of the block (**what requires translation**). You can learn these names by looking at the source code of the plugin/themes where these blocks are defined or by contacting the developer.\n*Unfortunately, a simpler method has not yet been found.*","zu-translate"),blockTitle:h("Supported blocks","zu-translate"),moreTitle:h("Add more blocks","zu-translate"),ignoreCptTitle:h("Ignore Custom Post Types","zu-translate"),toggles:["sync","initial","session","unsaved","nobackups"],sync:{label:h("Synchronize language switching","zu-translate"),help:h("Switching a language in one block will lead to language switching in all editable blocks.","zu-translate")},initial:{label:h("Open language panel","zu-translate"),help:h("Whether or not the language switching panel will start open.","zu-translate")},session:{label:h("Support session language","zu-translate"),help:h("During one session, language switching on different pages will be synchronized.","zu-translate")},unsaved:{label:h("Switch without changes","zu-translate"),help:h("Do not consider language switching as **unsaved** changes for the current edit session.","zu-translate")},nobackups:{label:h('Remove Block Editor "backups"',"zu-translate"),help:h("Removes Wordpress *autosaves* and *backups* notices which could be very annoying.\nYou should understand what you are doing.","zu-translate")},ignore_cpt:{cptLabel:h("Custom post types that will be ignored","zu-translate"),cptInput:h("Enter the custom post type","zu-translate"),cptInputHelp:h("Usually the custom post type is one word, like `product` for **WooCommerce** plugin","zu-translate")},custom:{nameLabel:h("Block name","zu-translate"),nameHelp:h("The block name must contain a **namespace** and a **slash**, for example, `core/quote`","zu-translate"),attsLabel:h("Attribute names","zu-translate"),attsInput:h("Enter the name of the attribute","zu-translate"),attsInputHelp:h("Usually the attribute has the name `content`, but it is not always so (see note above)","zu-translate"),addBlock:h("Add block","zu-translate")},resetAll:h("Reset Block Editor Settings","zu-translate"),errName:h("It does not look like a valid **block name**. Maybe you forgot the `namespace`? ","zu-translate"),errAtts:h("You need to specify at least one **attribute** for translation.","zu-translate"),errDups:h("Duplicates are not allowed. Are you mistaken in the name of the block?","zu-translate")},S={convertLabel:h("Convert Classic Blocks","zu-translate"),convertHelp:h("Convert all **Classic Blocks** to Gutenberg blocks. Regular text will be replaced with `core/paragraph`, headings with `core/heading` and shortcodes with `core/shortcode` blocks.","zu-translate"),convertAction:h("Convert","zu-translate"),convertTitle:h("Select options for conversion","zu-translate"),convertTypeLabel:h("Select a type for conversion","zu-translate"),convertOnlySelected:h("Convert only selected posts","zu-translate"),convertSelect:h("Select the %s for conversion","zu-translate"),splitLabel:h("Split Classic Blocks","zu-translate"),splitHelp:h("All **Classic Blocks** found will be split by languages and the contents of the block for each language will be converted to the `Gutenberg` blocks and will be saved in a separate document.","zu-translate"),splitAction:h("Split","zu-translate"),splitTitle:h("Select options for split","zu-translate"),splitTypeLabel:h("Select a type for split","zu-translate"),splitOnlySelected:h("Split only selected posts","zu-translate"),splitSelect:h("Select the %s for split","zu-translate"),primaryLabel:h("Select a primary language","zu-translate"),primaryHelp:h("The contents of the block for this language will be used as a **basis** for conversion.","zu-translate")},R,O={options:z,panels:{gutenberg:{value:!0,label:h("Block Editor Support","zu-translate"),depends:"gutenberg"},switcher:{value:!1,label:h("Language Switcher","zu-translate")}},switcher:_,gutenberg:E,convert:S,inacive:!!y&&g(k,{br:!0,links:w})},C=lodash,A=C.isEmpty,T=C.castArray,L=C.get,j=C.has,N=C.map,B=C.mapKeys,x=C.join,P=C.split,H=C.compact,I=C.includes,D=C.without,M=C.pick,q=C.omit,W=C.keys,U=wp.i18n.__,Y=wp.components,Z=Y.Button,F=Y.CheckboxControl,G=Y.PanelBody,K=wp.element,X=K.useCallback,Q=K.useState,J=wp.zukit.render.toggleOption,V=wp.zukit.components,ee=V.ZukitPanel,te=V.AdvTextControl,ne=V.ListInputControl,ae=wp.zukit.utils,le=ae.simpleMarkdown,oe=ae.getExternalData,re=ae.messageWithError,se=wp.zukit.jq.scrollTop,ie="blockeditor",ce=oe("supported",{}),ue=function e(o){var r=o.data,s=o.options,i=o.updateOptions,c=o.resetOptions,u=o.ajaxAction,p,d=o.noticeOperations.createNotice,h=L(s,ie,{}),g=h.excluded,f=h.custom,v=h.ignore_cpt,y,w=a(Q(""),2),k=w[0],z=w[1],_,E=a(Q(""),2),S=E[0],R=E[1],O,C=a(Q(ce),2),T=C[0],j=C[1],x=X((function(){c(ie,(function(){return u("zutranslate_reset_supported",(function(e){j(e),se()}))}))}),[c,u]),P=X((function(e){var t=B(e,(function(e,t){return"".concat(ie,".").concat(t)}));i(t)}),[i]),H=X((function(e,t){P(e?{excluded:D(g,t)}:{excluded:[].concat(l(g),[t])})}),[g,P]),U=X((function(){var e=m(k,S,f),a=e.name,l=e.atts,o=e.error;null===o?(P({custom:t(t({},f),{},n({},a,{title:a,atts:l}))}),z(""),R("")):(d({status:"warning",content:re(r[o.msg],o.value),isDismissible:!0,__unstableHTML:!0}),se())}),[f,k,S,P,d,r]),Y=q(T,W(f)),K=!A(f);return React.createElement(ee,{id:"gutenberg",options:s,initialOpen:!0},J(M(r,r.toggles),h,P),React.createElement("div",{className:"__note"},le(r.note,{br:!0})),React.createElement(G,{className:"__subtitle",title:r.blockTitle,initialOpen:!1},React.createElement("div",{className:"__supported"},N(Y,(function(e,t){var n=e.title,a=e.atts;return React.createElement(F,{key:t,label:n,help:b(a),checked:!I(g,t),onChange:function e(n){return H(n,t)}})})))),K&&React.createElement("div",{className:"__supported"},N(f,(function(e,t){var n=e.title,a=e.atts;return React.createElement(F,{key:t,label:n,help:b(a),checked:!I(g,t),onChange:function e(n){return H(n,t)}})}))),React.createElement(G,{className:"__subtitle",title:r.moreTitle,initialOpen:!1},React.createElement("div",{className:"__custom"},React.createElement(te,{label:r.custom.nameLabel,help:le(r.custom.nameHelp,{br:!0}),value:k,onChange:z,onKeyEnter:U}),React.createElement(ne,{isOpen:!0,isNotEmptyLabel:!0,strict:/^(?!\d)[\w$]+$/,label:r.custom.attsLabel,inputLabel:le(r.custom.attsInput,{br:!0}),inputHelp:le(r.custom.attsInputHelp,{br:!0}),value:S,onChange:R}),React.createElement(Z,{isSecondary:!0,className:"__plugin_actions __auto green",label:r.custom.addBlock,icon:"plus-alt",onClick:U},r.custom.addBlock))),React.createElement(G,{className:"__subtitle",title:r.ignoreCptTitle,initialOpen:!1},React.createElement("div",{className:"__cpt"},React.createElement(ne,{strict:/^(?!\d)[\w$]+$/,label:r.ignore_cpt.cptLabel,inputLabel:le(r.ignore_cpt.cptInput,{br:!0}),inputHelp:le(r.ignore_cpt.cptInputHelp,{br:!0}),value:v,onChange:function e(t){return P({ignore_cpt:t})}}))),React.createElement("div",{className:"__flex __right"},React.createElement(Z,{isSecondary:!0,className:"__plugin_actions __auto magenta",label:r.resetAll,icon:"image-rotate",onClick:x},r.resetAll)))},pe=lodash,de=pe.isEmpty,be=pe.map,me=pe.get,he=pe.reject,ge=pe.find,fe=pe.pick,ve=pe.includes,ye=pe.reduce,we=wp.i18n,ke=we.__,ze=we.sprintf,_e=wp.components,Ee=_e.Popover,Se=_e.Button,Re=_e.SelectControl,Oe=wp.blockEditor.BlockIcon,Ce=wp.element,Ae=Ce.useState,Te=Ce.useRef,Le=Ce.useCallback,je=wp.data.useSelect,Ne=wp.zukit.icons.close,Be=wp.zukit.utils,xe=Be.getExternalData,Pe=Be.simpleMarkdown,He=Be.unescapeHtml,Ie=wp.zukit.components,De=Ie.ZukitSidebar,Me=Ie.ZukitToggle,$e="zutranslate_convert",qe="superhero",We="star-half",Ue=["attachment","wp_block","nav_menu_item","wp_template","wp_template_part","wp_navigation"],Ye=[{value:0,label:"Loading..."}],Ze=ye(xe("qtxlangs",{}),(function(e,t){return e.push({value:t.code,label:t.name,active:t.active}),e}),[]),Fe=function e(t){var n,l,o=t.data,r=t.ajaxAction,s,i=a(Ae(!1),2),c=i[0],u=i[1],p,d=a(Ae("convert"),2),b=d[0],m=d[1],h="convert"===b,g=Te({types:null,posts:null}),f,v=a(Ae(0),2),y=v[0],w=v[1],k,z=a(Ae(""),2),_=z[0],E=z[1],S,R=a(Ae(!1),2),O=R[0],C=R[1],A,T=a(Ae(0),2),L=T[0],j=T[1],N,B=a(Ae(null===(n=ge(Ze,["active",!0]))||void 0===n?void 0:n.value),2),x=B[0],P=B[1],H=Te(null),I=Te(null),D=je((function(e){if(null===(null==g?void 0:g.current.types)){var t=e("core").getPostTypes();if(!de(t)){var n=he(be(t,(function(e){return fe(e,["name","slug","labels"])})),(function(e){return ve(Ue,e.slug)}));g.current.types=ye(n,(function(e,t){return e.push({value:t.slug,label:t.labels.singular_name}),e}),[{value:0,label:"Select type"}])}}return null!=g&&g.current.types?g.current.types:Ye})),M=h?o.convertSelect:o.splitSelect,q=Le((function(e){var t,n=null===(t=ge(D,{value:e}))||void 0===t?void 0:t.label.toLowerCase();w(e),E([ze(M,n),ze(ke("Select %s","zu-translate"),n)]),g.current.posts=null}),[M,D]),W=je((function(e){var t=e("core"),n=t.getEntityRecords,a=t.hasFinishedResolution,l=["postType",y];if(y&&O&&null===(null==g?void 0:g.current.posts)){var o=n.apply(void 0,l);de(o)||(g.current.posts=ye(o,(function(e,t){return e.push({value:t.id,label:He(t.title.rendered)}),e}),[{value:0,label:_[1]}]))}return{postOptions:null==g?void 0:g.current.posts,hasResolved:y&&O&&a("getEntityRecords",l)}}),[y,O,_]),U=W.postOptions,Y=W.hasResolved,Z=Le((function(e){u(!c),m(e)}),[c]),F=Le((function(){u(!1)}),[]),G=Le((function(){u(!1),r({action:"zutranslate_".concat(b,"_classic"),value:{id:O?L:0,postType:y,primaryLang:x}})}),[b,L,y,x,O,r]),K=O?0===L:0===y,X=null===(l=me(h?H:I,"current"))||void 0===l?void 0:l.getBoundingClientRect();return React.createElement(De.MoreActions,null,React.createElement(De.ActionButton,{color:"magenta",icon:qe,onClick:function e(){return Z("convert")},label:o.convertLabel,help:o.convertHelp,ref:H}),React.createElement(De.ActionButton,{color:"blue",icon:We,onClick:function e(){return Z("split")},label:o.splitLabel,help:o.splitHelp,ref:I}),c&&React.createElement(Ee,{position:"middle left",noArrow:!1,onClose:F,anchorRect:X,focusOnMount:!1},React.createElement("div",{className:$e},React.createElement("div",{className:"__title"},React.createElement(Oe,{icon:h?qe:We}),React.createElement("span",null,h?o.convertTitle:o.splitTitle),React.createElement(Se,{className:"__close",icon:Ne,onClick:F})),React.createElement("div",{className:"__body"},React.createElement(Re,{label:h?o.convertTypeLabel:o.splitTypeLabel,value:y,onChange:q,options:D}),!!y&&React.createElement(Me,{label:h?o.convertOnlySelected:o.splitOnlySelected,checked:O,onChange:function e(){return C(!O)}}),O&&React.createElement(Re,{label:_[0],value:L,onChange:j,options:Y?U:Ye}),h&&React.createElement(Re,{className:"__lang",label:o.primaryLabel,help:Pe(o.primaryHelp),value:x,onChange:P,options:Ze}),React.createElement("div",{className:"__submit"},React.createElement(Se,{isPrimary:!0,disabled:K,icon:"editor-table",onClick:G},h?o.convertAction:o.splitAction))))))},Ge=wp.zukit.render,Ke=Ge.renderPage,Xe=Ge.toggleOption,Qe=wp.zukit.components.ZukitPanel,Je=O.options,Ve=O.gutenberg,et=O.inacive,tt=O.convert,nt=function e(t){var n=t.title,a=t.options,l=t.updateOptions,o=t.resetOptions,r=t.ajaxAction,s=t.noticeOperations;return et?React.createElement("div",{className:"__note"},et):React.createElement(React.Fragment,null,React.createElement(Qe,{title:n},Xe(Je,a,l)),React.createElement(ue,{data:Ve,options:a,updateOptions:l,resetOptions:o,noticeOperations:s,ajaxAction:r}),React.createElement(Fe,{data:tt,ajaxAction:r}))};Ke("zutranslate",{edit:nt,panels:O.panels})}();