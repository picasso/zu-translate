(function () {
  'use strict';

  function ownKeys(object, enumerableOnly) {
    var keys = Object.keys(object);

    if (Object.getOwnPropertySymbols) {
      var symbols = Object.getOwnPropertySymbols(object);

      if (enumerableOnly) {
        symbols = symbols.filter(function (sym) {
          return Object.getOwnPropertyDescriptor(object, sym).enumerable;
        });
      }

      keys.push.apply(keys, symbols);
    }

    return keys;
  }

  function _objectSpread2(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i] != null ? arguments[i] : {};

      if (i % 2) {
        ownKeys(Object(source), true).forEach(function (key) {
          _defineProperty(target, key, source[key]);
        });
      } else if (Object.getOwnPropertyDescriptors) {
        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
      } else {
        ownKeys(Object(source)).forEach(function (key) {
          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
        });
      }
    }

    return target;
  }

  function _typeof(obj) {
    "@babel/helpers - typeof";

    if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
      _typeof = function (obj) {
        return typeof obj;
      };
    } else {
      _typeof = function (obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
      };
    }

    return _typeof(obj);
  }

  function _defineProperty(obj, key, value) {
    if (key in obj) {
      Object.defineProperty(obj, key, {
        value: value,
        enumerable: true,
        configurable: true,
        writable: true
      });
    } else {
      obj[key] = value;
    }

    return obj;
  }

  function _extends() {
    _extends = Object.assign || function (target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i];

        for (var key in source) {
          if (Object.prototype.hasOwnProperty.call(source, key)) {
            target[key] = source[key];
          }
        }
      }

      return target;
    };

    return _extends.apply(this, arguments);
  }

  function _objectWithoutPropertiesLoose(source, excluded) {
    if (source == null) return {};
    var target = {};
    var sourceKeys = Object.keys(source);
    var key, i;

    for (i = 0; i < sourceKeys.length; i++) {
      key = sourceKeys[i];
      if (excluded.indexOf(key) >= 0) continue;
      target[key] = source[key];
    }

    return target;
  }

  function _objectWithoutProperties(source, excluded) {
    if (source == null) return {};

    var target = _objectWithoutPropertiesLoose(source, excluded);

    var key, i;

    if (Object.getOwnPropertySymbols) {
      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);

      for (i = 0; i < sourceSymbolKeys.length; i++) {
        key = sourceSymbolKeys[i];
        if (excluded.indexOf(key) >= 0) continue;
        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;
        target[key] = source[key];
      }
    }

    return target;
  }

  function _slicedToArray(arr, i) {
    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();
  }

  function _toConsumableArray(arr) {
    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();
  }

  function _arrayWithoutHoles(arr) {
    if (Array.isArray(arr)) return _arrayLikeToArray(arr);
  }

  function _arrayWithHoles(arr) {
    if (Array.isArray(arr)) return arr;
  }

  function _iterableToArray(iter) {
    if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter);
  }

  function _iterableToArrayLimit(arr, i) {
    var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"];

    if (_i == null) return;
    var _arr = [];
    var _n = true;
    var _d = false;

    var _s, _e;

    try {
      for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {
        _arr.push(_s.value);

        if (i && _arr.length === i) break;
      }
    } catch (err) {
      _d = true;
      _e = err;
    } finally {
      try {
        if (!_n && _i["return"] != null) _i["return"]();
      } finally {
        if (_d) throw _e;
      }
    }

    return _arr;
  }

  function _unsupportedIterableToArray(o, minLen) {
    if (!o) return;
    if (typeof o === "string") return _arrayLikeToArray(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor) n = o.constructor.name;
    if (n === "Map" || n === "Set") return Array.from(o);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
  }

  function _arrayLikeToArray(arr, len) {
    if (len == null || len > arr.length) len = arr.length;

    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];

    return arr2;
  }

  function _nonIterableSpread() {
    throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }

  function _nonIterableRest() {
    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }

  var classnames$1 = {exports: {}};

  /*
    Copyright (c) 2018 Jed Watson.
    Licensed under the MIT License (MIT), see
    http://jedwatson.github.io/classnames
  */

  (function (module) {
  /* global define */

  (function () {

  	var hasOwn = {}.hasOwnProperty;

  	function classNames() {
  		var classes = [];

  		for (var i = 0; i < arguments.length; i++) {
  			var arg = arguments[i];
  			if (!arg) continue;

  			var argType = typeof arg;

  			if (argType === 'string' || argType === 'number') {
  				classes.push(arg);
  			} else if (Array.isArray(arg)) {
  				if (arg.length) {
  					var inner = classNames.apply(null, arg);
  					if (inner) {
  						classes.push(inner);
  					}
  				}
  			} else if (argType === 'object') {
  				if (arg.toString === Object.prototype.toString) {
  					for (var key in arg) {
  						if (hasOwn.call(arg, key) && arg[key]) {
  							classes.push(key);
  						}
  					}
  				} else {
  					classes.push(arg.toString());
  				}
  			}
  		}

  		return classes.join(' ');
  	}

  	if (module.exports) {
  		classNames.default = classNames;
  		module.exports = classNames;
  	} else {
  		window.classNames = classNames;
  	}
  }());
  }(classnames$1));

  var classnames = classnames$1.exports;

  var _$2 = lodash;
  var __$8 = wp.i18n.__;
  var _wp$components$b = wp.components,
      Path$1 = _wp$components$b.Path,
      G$1 = _wp$components$b.G,
      SVG$1 = _wp$components$b.SVG;
  var _wp$blocks = wp.blocks,
      getCategories = _wp$blocks.getCategories,
      setCategories = _wp$blocks.setCategories,
      registerBlockCollection = _wp$blocks.registerBlockCollection;
  var extData = null; // Gets JSON data from PHP

  function externalData(key) {
    var defaultValues = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

    var _ref = window[key] || {},
        _ref$data = _ref.data,
        data = _ref$data === void 0 ? {} : _ref$data;

    extData = _$2.isEmpty(defaultValues) ? data : _$2.defaults(data, defaultValues);
    return extData;
  } // Allows multiple access to external data after calling 'externalData' function

  function getExternalData() {
    var key = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
    var defaultValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
    if (_$2.isEmpty(extData)) window.console.warn('ZUKIT: utils.externalData(<your_key>) should be called before any getExternalData() call!');
    if (key === null) return extData;
    return _$2.get(extData, key, defaultValue);
  } // Just a more familiar name

  var mergeClasses = classnames; // Checks if value can be converted to Number

  function isNum(n) {
    return !_$2.isNaN(parseFloat(n)) && isFinite(n);
  } // convert argument to Boolean value
  // works for true, false, 0, 1, "true", "false", "TRUE", "FALSE", "0", "1", undefined

  function toBool(val) {
    var stringOrNull = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var num;
    var value = val != null && (!_$2.isNaN(num = +val) ? !!num : !!String(val).toLowerCase().replace(!!0, ''));
    return stringOrNull ? value ? String(value) : null : value;
  }
  function toRange(num, min, max) {
    var useMinOnErr = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;
    var value = _$2.isNaN(+num) ? useMinOnErr ? min : max : num;
    return _$2.clamp(_$2.round(value), min, max);
  } // Create key for react components from 'value' or other params

  function getKey(value, more) {
    var source = _$2.isString(value) || isNum(value) ? String(value) : String(more);
    var hash = 0,
        i;

    for (i = 0; i < source.length; i++) {
      hash = (hash << 5) - hash + source.charCodeAt(i);
      hash |= 0; // Convert to 32bit integer
    }

    return String(hash);
  }
  function isWrongId(id) {
    return _$2.isNil(id) || isNum(id) && parseInt(id, 10) === 0;
  } // Creates an 'ids' array from an array (which should have property 'id').
  // Ensures the ids array contains numbers

  function getIds(items) {
    var asString = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    // always ensure the ids array contains numbers.
    // And remove all elements with "empty" value (undefined, null)
    if (!items || items.length === 0) return asString ? '' : [];

    var ids = _$2.compact(_$2.map(items, function (value) {
      return value && value.id && parseInt(value.id, 10);
    }));

    return asString ? _$2.join(ids, ',') : ids;
  }
  function checkDependency(item, options) {
    var isAction = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    var withPath = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;
    var depends = isAction ? item : _$2.get(item, 'depends'); // special case when we need to avoid the element with the key 'hasMoreActions'

    if (_$2.get(item, 'hasMoreActions') === true) return false;
    if (_$2.isNil(depends)) return true;
    if (depends === false) return false;
    depends = _$2.castArray(depends); // the first element of the array determines what the logical operator will be (comparison by AND or OR)
    // if the first element is not equal to '&&' or '||', then the comparison will be by OR

    var logicalOp = depends[0] === '&&' || depends[0] === '||';
    var logicalAND = depends[0] === '&&';
    return _$2.reduce(logicalOp ? _$2.drop(depends, 1) : depends, function (acc, dependencyKey) {
      var cleanKey = _$2.trimStart(dependencyKey, '!');

      var value = _$2.get(options, withPath ? "".concat(withPath, ".").concat(cleanKey) : cleanKey, false);

      value = _$2.startsWith(depends, '!') ? !value : value;
      return acc === null ? value : logicalAND ? acc && value : acc || value;
    }, null);
  } // Convert object to JSON

  function toJSON(obj) {
    if (obj) {
      try {
        obj = JSON.stringify(obj);
      } catch (err) {
        obj = '{}';
      }
    }

    return obj || '{}';
  } // Creates a new value using the template '<text>-<index>' while avoiding values from 'forbiddenValues'

  var uniqueValue = function uniqueValue(value, forbiddenValues) {
    var fallback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'name';
    var formatted = String(value).replace(/([^-|\d])(\d+)$/, '$1-$2');

    if (_$2.includes(forbiddenValues, formatted)) {
      var index = 0;
      var valueBody = String(formatted).replace(/-\d+$/, '').replace(/\d+$/, '') || fallback;

      while (++index > 0) {
        var testValue = "".concat(valueBody, "-").concat(index);
        if (!_$2.includes(forbiddenValues, testValue)) return testValue;
      }
    }

    return formatted;
  }; // Add error value (if present) to the message, converting any object to a string

  function messageWithError(message) {
    var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
    var mdMessage = simpleMarkdown(message, {
      raw: true,
      br: true,
      json: true
    });
    if (_$2.isNil(value)) return mdMessage;
    value = _$2.isArray(value) || _$2.isPlainObject(value) ? toJSON(value) : String(value);
    value = value.replace(/([{|}])/g, ' $1 ').replace(/,\s*/g, ',  ').replace(/"([^"]+)":/g, '<b>$1</b>: ');
    var noColon = /[?|!.]\s*$/.test(message);
    return mdMessage.replace(/[:|.]\s*$/g, '') + "".concat(noColon ? '' : ':', " <span class=\"zukit-data\">").concat(value, "</span>");
  } // Returns SVG with a reference to an already loaded SVG set

  function svgRef(id) {
    var icon = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var moreClasses = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';
    var iconsSize = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 24;
    return /*#__PURE__*/React.createElement("svg", {
      className: classnames('zu-svg', {
        icon: icon
      }, "icon-".concat(id), moreClasses),
      role: "img",
      "aria-labelledby": "title",
      viewBox: "0 0 ".concat(iconsSize, " ").concat(iconsSize),
      preserveAspectRatio: "xMidYMin slice"
    }, /*#__PURE__*/React.createElement("use", {
      href: "#".concat(id)
    }));
  }
  function hexToRGB(hex) {
    var asObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    var rgb = result ? {
      r: parseInt(result[1], 16),
      g: parseInt(result[2], 16),
      b: parseInt(result[3], 16)
    } : null;
    return rgb ? asObject ? rgb : "rgb(".concat(rgb.r, ",").concat(rgb.g, ",").concat(rgb.b, ")") : null;
  }
  function hexToRGBA(hex, alpha) {
    var asObject = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    var rgb = hexToRGB(hex, true);
    if (rgb === null) return null;

    var rgba = _$2.set(_objectSpread2({}, rgb), 'a', alpha);

    return asObject ? rgba : "rgba(".concat(rgba.r, ",").concat(rgba.g, ",").concat(rgba.b, ",").concat(rgba.a, ")");
  } // Compare version numbers with segments
  // Return values:
  // 		a number < 0 if a < b
  //		a number > 0 if a > b
  //		0 if a = b

  function compareVersions(a, b) {
    var i, diff;
    var regExStrip0 = /(\.0+)+$/;
    var segmentsA = String(a).replace(regExStrip0, '').split('.');
    var segmentsB = String(b).replace(regExStrip0, '').split('.');
    var l = Math.min(segmentsA.length, segmentsB.length);

    for (i = 0; i < l; i++) {
      diff = parseInt(segmentsA[i], 10) - parseInt(segmentsB[i], 10);
      if (diff) return diff;
    }

    return segmentsA.length - segmentsB.length;
  } // Converts a string to a set of React components based on simple Markdown constructs
  // replaces **text** with <strong>text</strong>
  // replaces *text* with <em>text</em>
  // NOTE: Attention! Doesn't work for two blocks not separated by anything:
  // *text1**text2* - doesn't work!  *text1* *text2* - works!
  // replaces `text` with <span>text</span>
  // NOTE: Attention! Doesn't work for two blocks not separated by anything:
  // `text1``text2` - doesn't work!  `text1` `text2` - works!
  // replaces [text](link) with <a href="link">text</a>
  // replaces newlines with <p> or <br/> if 'params.br' is true
  // also replaces $link<index> constructs with elements from the 'params.links' array

  function simpleMarkdown(string, params) {
    if (!_$2.isString(string)) return string;

    var mod = _$2.defaults(params, {
      links: null,
      br: false,
      externalLink: true,
      raw: false,
      json: false,
      container: false
    });

    var linkReplace = '<a href="$2" target="_blank" rel="external noreferrer noopener">$1</a>';
    if (mod.externalLink) linkReplace = linkReplace.replace('<a', '<a class="components-external-link"'); // replace links

    var md = _$2.reduce(_$2.castArray(mod.links || []), function (msg, link, index) {
      return msg.replace("$link".concat(index + 1), link);
    }, string); // replace <strong>


    md = md.replace(/\*\*([^*]+)\*\*/gm, '<strong>$1</strong>'); // replace <em>

    md = md.replace(/(^|[^*])\*([^*]+)\*/gm, '$1<em>$2</em>'); // replace <span>

    md = md.replace(/(^|[^`])`([^`]+)`/gm, '$1<span class="__code">$2</span>'); // replace <a>

    md = md.replace(/\[([^\]]+)\]\(([^)]+)\)/gm, linkReplace); // add <p></p> or <br/> if '\n' are found

    if (_$2.includes(md, '\n') || mod.json && _$2.includes(md, '\\n')) {
      var regex = mod.json ? /\\n/gm : /\n/gm;
      if (mod.br) md = md.replace(regex, '<br/>');else md = md.split(mod.json ? '\\n' : '\n').map(function (line) {
        return "<p>".concat(line, "</p>");
      }).join('');
    } // return earlier if 'raw' output requested or no tags are found


    if (mod.raw) return md;
    if (md.match(/<[^<]+>/gm) === null) return string;
    var body = string2dom(md);
    var markdown = /*#__PURE__*/React.createElement(React.Fragment, null, _$2.map(body.childNodes, node2comp));
    return mod.container ? /*#__PURE__*/React.createElement("span", {
      className: "__markdown"
    }, markdown) : markdown;
  }

  function string2dom(string) {
    var el = document.createElement('html');
    el.innerHTML = string;
    return _$2.find(el.childNodes, {
      nodeName: 'BODY'
    });
  }

  function styledIcon(icon) {
    var styled = {
      width: '1.4em',
      height: '1.4em',
      margin: '-0.2em 0.1em 0 0.2em',
      verticalAlign: 'middle',
      fill: 'currentColor'
    };
    var icons = {
      external: "M18.2 17c0 .7-.6 1.2-1.2 1.2H7c-.7 0-1.2-.6-1.2-1.2V7c0-.7.6-1.2 " + "1.2-1.2h3.2V4.2H7C5.5 4.2 4.2 5.5 4.2 7v10c0 1.5 1.2 2.8 2.8 2.8h10c1.5 0 2.8-1.2 " + "2.8-2.8v-3.6h-1.5V17zM14.9 3v1.5h3.7l-6.4 6.4 1.1 1.1 6.4-6.4v3.7h1.5V3h-6.3z"
    };
    return /*#__PURE__*/React.createElement(SVG$1, {
      xmlns: "http://www.w3.org/2000/svg",
      viewBox: "0 0 24 24",
      width: "24",
      height: "24",
      className: "components-external-link__icon",
      role: "img",
      "aria-hidden": "true",
      focusable: "false",
      style: styled
    }, /*#__PURE__*/React.createElement(Path$1, {
      d: _$2.get(icons, icon, '')
    }));
  }

  function node2comp(node, index) {
    var tag = String(node.nodeName).toLowerCase();
    if (tag === 'strong') return /*#__PURE__*/React.createElement("strong", {
      key: index,
      className: node.className || null
    }, node.textContent);
    if (tag === 'em') return /*#__PURE__*/React.createElement("em", {
      key: index,
      className: node.className || null
    }, node.textContent);
    if (tag === 'span') return /*#__PURE__*/React.createElement("span", {
      key: index,
      className: node.className || null
    }, node.textContent);
    if (tag === 'br') return /*#__PURE__*/React.createElement("br", {
      key: index
    });
    if (tag === '#text') return node.textContent;
    if (tag === 'p') return /*#__PURE__*/React.createElement("p", {
      key: index,
      className: node.className || null
    }, _$2.map(node.childNodes, node2comp));
    if (tag === 'a') return /*#__PURE__*/React.createElement("a", {
      key: index,
      className: node.className || null,
      href: node.href,
      rel: node.rel,
      target: node.target
    }, _$2.map(node.childNodes, node2comp), _$2.includes(node.className, 'components-external-link') && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement("span", {
      className: "components-visually-hidden"
    }, "(opens in a new tab)"), styledIcon('external')));
  } // Some useful data -----------------------------------------------------------]


  var emptyGif = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';

  var _externalData = externalData('zukit_jsdata'),
      _externalData$colors = _externalData.colors,
      zukitRawColors = _externalData$colors === void 0 ? {} : _externalData$colors; // Returns one of predefined in SASS files colors


  function getColor(key) {
    var defaultColor = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '#cc1818';
    return _$2.get(zukitRawColors, key, defaultColor);
  }
  function getColorOptions(colors) {
    var initialValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
    var mergeWithZukit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

    var options = _$2.reduce(colors, function (values, color, colorName) {
      values.push({
        slug: colorName,
        color: color,
        name: _$2.startCase(_$2.replace(colorName, '_', ' '))
      });
      return values;
    }, initialValue); // if we need to merge with zukitColors, then remove all options with the same 'slug'
    // if 'mergeWithZukit' is array - use it as list of slugs to be excluded


    if (mergeWithZukit) {
      var slugs = _$2.concat(_$2.map(options, 'slug'), _$2.isArray(mergeWithZukit) ? mergeWithZukit : []);

      var withoutSlugs = _$2.filter(zukitColors, function (val) {
        return !_$2.includes(slugs, val.slug);
      });

      return _$2.concat(options, withoutSlugs);
    }

    return options;
  } // creates Zikit Color Options

  var zukitColors = getColorOptions(zukitRawColors, [{
    slug: 'none',
    color: 'white',
    name: 'None'
  }]); // Brand assets ---------------------------------------------------------------]

  var brandAssets = {
    namespace: 'zu',
    slug: 'zu-blocks',
    color: getColor('violet'),
    icon: null,
    title: __$8('Zu Blocks', 'zukit')
  };
  brandAssets.icon = /*#__PURE__*/React.createElement(SVG$1, {
    width: "24",
    height: "24",
    viewBox: "0 0 24 24",
    xmlns: "http://www.w3.org/2000/svg"
  }, /*#__PURE__*/React.createElement(G$1, null, /*#__PURE__*/React.createElement(Path$1, {
    d: "M15.22,6.873 C15.22,6.873 14.383,8.096 13.914,12.049 C13.445,16.006 " + "17.266,15.5 17.266,15.5 Q19.264,15.312 19.264,13.224 C19.264,13.224 " + "19.172,6.516 19.264,6.873 C20.766,9.109 23.242,6.873 23.242,6.873 " + "L23.242,13.993 Q23.242,16.279 21.737,17.422 Q20.231,18.565 17.242,18.565 " + "Q14.42,18.27 12.914,17.127 C12.914,17.127 11.336,16.393 10.367,13.908 C9.107,10.676 11.242,6.873 11.242,6.873 z",
    fill: brandAssets.color
  }), /*#__PURE__*/React.createElement(Path$1, {
    d: "M7.448,14.858 C8.266,16.469 11.164,15.236 11.164,15.236 L17.242,18.565 " + "L0.758,18.565 L6.08,10.203 L1.47,10.203 C1.47,10.203 3.141,7.828 1.47,6.873 " + "C0.922,6.844 12.742,6.873 12.742,6.873 C12.742,6.873 6.256,12.508 7.448,14.858 z",
    fill: brandAssets.color
  }))); // Register ZU blocks category (or any other if 'categoryData' is presented)

  function registerCategory() {
    var categoryData = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
    var category = _$2.isEmpty(categoryData) ? {
      slug: brandAssets.slug,
      title: brandAssets.title,
      icon: brandAssets.icon
    } : categoryData;
    setCategories([category].concat(_toConsumableArray(getCategories().filter(function (_ref2) {
      var slug = _ref2.slug;
      return slug !== category.slug;
    }))));
  }
  function registerCollection() {
    var collectionData = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
    var collection = _$2.isEmpty(collectionData) ? {
      namespace: brandAssets.namespace,
      title: brandAssets.title,
      icon: brandAssets.icon
    } : collectionData;

    if (typeof registerBlockCollection === 'function') {
      registerBlockCollection(collection.namespace, collection);
      return true;
    }

    return false;
  } // Subset of functions for 'zukit-blocks'

  var blocksSet$2 = {
    registerCategory: registerCategory,
    registerCollection: registerCollection,
    externalData: externalData,
    getExternalData: getExternalData,
    mergeClasses: mergeClasses,
    hexToRGB: hexToRGB,
    hexToRGBA: hexToRGBA,
    isNum: isNum,
    isWrongId: isWrongId,
    toBool: toBool,
    toRange: toRange,
    getKey: getKey,
    getIds: getIds,
    getColor: getColor,
    getColorOptions: getColorOptions,
    toJSON: toJSON,
    uniqueValue: uniqueValue,
    svgRef: svgRef,
    compareVersions: compareVersions,
    simpleMarkdown: simpleMarkdown,
    emptyGif: emptyGif,
    brandAssets: brandAssets
  };

  var utils = /*#__PURE__*/Object.freeze({
    __proto__: null,
    externalData: externalData,
    getExternalData: getExternalData,
    mergeClasses: mergeClasses,
    isNum: isNum,
    toBool: toBool,
    toRange: toRange,
    getKey: getKey,
    isWrongId: isWrongId,
    getIds: getIds,
    checkDependency: checkDependency,
    toJSON: toJSON,
    uniqueValue: uniqueValue,
    messageWithError: messageWithError,
    svgRef: svgRef,
    hexToRGB: hexToRGB,
    hexToRGBA: hexToRGBA,
    compareVersions: compareVersions,
    simpleMarkdown: simpleMarkdown,
    emptyGif: emptyGif,
    getColor: getColor,
    getColorOptions: getColorOptions,
    brandAssets: brandAssets,
    registerCategory: registerCategory,
    registerCollection: registerCollection,
    blocksSet: blocksSet$2
  });

  // WordPress dependencies
  var _$1 = lodash;
  var _wp$1 = wp,
      apiFetch$1 = _wp$1.apiFetch; // Internal dependencies
  var cacheKey = 'cache';
  var routerKey = 'router';
  var restDefaults = {
    router: null,
    root: 'zukit',
    version: 1
  };
  var apiBaseURL = "/".concat(restDefaults.root, "/v").concat(restDefaults.version, "/"); // restRouter serves to identify the plugin that currently uses the REST API,
  // since all plugins inherit the same Zukit_plugin class and identification
  // is required to determine which of the active plugins should respond to ajax requests.
  // Therefore, we automatically add the 'router' param to all API request.

  var restRouter = null;
  var restBasics = restDefaults; // Ajax actions and options update --------------------------------------------]
  // Если status === 'data' просто возвращаем данные из property 'data',
  // в противном случае формируем и отображаем 'Notice'

  function onSuccessAjax(createNotice, request) {
    var callback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
    var loading = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;

    var actionKey = _$1.get(request, 'options.key'); // const actionData = [{ className: 'zukit-data', label: actionKey }];


    return function (ajaxData) {
      var _ref = ajaxData || {},
          _ref$status = _ref.status,
          status = _ref$status === void 0 ? 'warning' : _ref$status,
          content = _ref.content,
          _ref$data = _ref.data,
          data = _ref$data === void 0 ? null : _ref$data,
          withData = _ref.withData,
          _ref$withHTML = _ref.withHTML,
          withHTML = _ref$withHTML === void 0 ? true : _ref$withHTML,
          message = _ref.message,
          params = _ref.params; // mark action as 'complete'


      if (_$1.isFunction(loading)) loading(_defineProperty({}, actionKey, false)); // Если 'notice' combined with 'data' - transform to 'real' status

      if (status !== 'data' && _$1.includes(status, 'data')) {
        status = status.replace('data', '');
        withData = true;
      } // if 'data' - pass it to callback


      if (status === 'data' || withData) {
        if (_$1.isFunction(callback)) callback(data);
      } // if 'soft' error message


      if (status === false && message) {
        status = 'error';
        content = message;
      }

      if (_$1.isNil(content)) {
        content = 'Unknown action';
        params = {
          action: actionKey
        };
      }

      if (status !== 'data') {
        createNotice({
          status: status,
          // Can be one of: success, info, warning, error
          content: messageWithError(content, params),
          // Text string to display
          isDismissible: true,
          // Whether the user can dismiss the notice
          // actions: params,							// Any actions the user can perform
          __unstableHTML: withHTML
        });
      }
    };
  }

  function onErrorAjax(createNotice, request, loading) {
    var requestKey = _$1.get(request, 'options.key') || _$1.get(request, 'options.keys');

    return function (error) {
      // mark action as 'complete'
      if (_$1.isFunction(loading)) loading(_defineProperty({}, requestKey, false));

      var _parseError = parseError(error, {
        action: requestKey
      }),
          _parseError2 = _slicedToArray(_parseError, 2),
          message = _parseError2[0],
          param = _parseError2[1]; // const { message = 'Unknown error:' } = error;


      createNotice({
        status: 'error',
        // Can be one of: success, info, warning, error
        content: messageWithError(message, param),
        // Text string to display
        isDismissible: true,
        // Whether the user can dismiss the notice
        // actions: param ? [{ className: 'zukit-data', label: param }] : null,
        __unstableHTML: true
      });
    };
  } // We are trying to find a hook based on options changes (considering cases when
  // key can contain path)


  function getHook(hooks, update) {
    var key = _$1.first(_$1.keys(update));

    var hook = _$1.get(hooks, key);

    if (_$1.isNil(hook)) {
      // here we check different cases when key is path (dot separated)
      if (update[key] !== null) {
        // when the whole object is updated and the hook is set to a nested property
        _$1.forEach(hooks || {}, function (h, k) {
          if (_$1.get(update, k, null) !== null) {
            hook = h;
            key = k;
            return false;
          }
        });
      } else {
        // when an object is deleted and the hook is set to a nested property
        _$1.forEach(hooks || {}, function (h, k) {
          if (_$1.startsWith(k, key)) {
            hook = h;
            key = k;
            return false;
          }
        });
      }
    }

    return [key, hook];
  }

  function hookOptionsUpdate(updateValues, hooks, afterAjaxCallback) {
    var _getHook = getHook(hooks, updateValues),
        _getHook2 = _slicedToArray(_getHook, 2),
        updateKey = _getHook2[0],
        updateHook = _getHook2[1];

    if (!_$1.isFunction(updateHook) && !_$1.isFunction(afterAjaxCallback)) return _$1.noop; // const onUpdateCallback = ()

    return function () {
      if (_$1.isFunction(afterAjaxCallback)) afterAjaxCallback();
      if (_$1.isFunction(updateHook)) updateHook(updateKey, updateValues[updateKey]);
    };
  }

  function hookOptionsReset(options, hooks) {
    var _ref2 = options || {},
        _ref2$prev = _ref2.prev,
        prev = _ref2$prev === void 0 ? {} : _ref2$prev,
        _ref2$next = _ref2.next,
        next = _ref2$next === void 0 ? {} : _ref2$next;

    _$1.forEach(hooks || {}, function (hook, key) {
      // call hook only if value is changed
      if (_$1.isFunction(hook) && prev[key] !== next[key]) hook(key, next[key]);
    });
  }

  function ajaxDoAction(params, callback, createNotice, updateLoading) {
    var _ref3 = _$1.isPlainObject(params) ? params : {
      action: params
    },
        action = _ref3.action,
        _ref3$value = _ref3.value,
        value = _ref3$value === void 0 ? null : _ref3$value;

    var requestData = {
      route: 'action',
      options: {
        key: action,
        value: value
      }
    }; // mark action as 'loading'

    updateLoading(_defineProperty({}, action, true));
    postAndCatchWithOptions(_objectSpread2(_objectSpread2({}, requestData), {}, {
      onSuccess: onSuccessAjax(createNotice, requestData, callback, updateLoading),
      onError: onErrorAjax(createNotice, requestData, updateLoading)
    }));
  }
  function ajaxUpdateOptions(keys, values, createNotice, updateHooks, onSuccessCallback) {
    // если 'keys' is null - значит это options reset и просто проверяем все hooks
    if (keys === null) {
      hookOptionsReset(values, updateHooks);
      return;
    } // если 'keys' простая строка и 'values' не содержит такого ключа - преобразовать
    // 'values' в нужную форму


    if (_$1.isString(keys) && !_$1.has(values, keys)) values = _defineProperty({}, keys, values);
    var requestData = {
      route: 'options',
      options: {
        // router: restRouter,
        keys: keys,
        values: values
      }
    };
    postAndCatchWithOptions(_objectSpread2(_objectSpread2({}, requestData), {}, {
      onSuccess: hookOptionsUpdate(values, updateHooks, onSuccessCallback),
      onError: onErrorAjax(createNotice)
    }));
  } // Some helpers for API fetch -------------------------------------------------]
  // Если сообщение об ошибке заканчивается ": <value>", то отделяем <value> от строки
  // сообщения и превращаем его в отдельный param

  function parseError(error, requestKey) {
    var _error$message = error.message,
        errMessage = _error$message === void 0 ? 'Unknown error:' : _error$message;
    var message = errMessage,
        param = requestKey;
    var match = /:\s*(.+)$/.exec(errMessage);

    if (match !== null) {
      message = errMessage.replace(match[1], '');
      param = _$1.isNil(param) ? match[1] : "".concat(match[1], " [").concat(param, "]");
    }

    return [message, param];
  } // Convert object to query string and skip "unwanted" properties


  function serializeData(data) {
    var cache = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var skip = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];

    // remove all elements with "empty" value (undefined, null)
    var obj = _$1.omitBy(data, _$1.isNil); // check for cacheKey in object and then remove it (skip) from serialization


    if (_$1.has(obj, cacheKey)) {
      cache = obj[cacheKey];
      skip.push(cacheKey);
    }

    var str = [];

    for (var p in obj) {
      if (_$1.has(obj, p) && !_$1.includes(skip, p)) {
        // process array as JSON if presented in value
        var value = _$1.isArray(obj[p]) ? toJSON(obj[p]) : obj[p];
        str.push("".concat(encodeURIComponent(p), "=").concat(encodeURIComponent(value)));
      }
    } // Automatically add the "router" param to all API request


    if (!_$1.has(obj, routerKey)) str.push("".concat(routerKey, "=").concat(encodeURIComponent(restRouter)));

    if (cache) {
      var random = Math.floor(Math.random() * 1000000);
      str.push("q=".concat(random));
    }

    return str.join('&');
  } // Check URL and transform it if needed


  function requestURL(url, options) {
    var router = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
    var picked = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];
    var customBaseURL = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;
    var baseURL = customBaseURL || apiBaseURL; // extend url with API base
    // and remove any leading and trailing slashes

    var requestUrl = !_$1.startsWith(url, baseURL) ? baseURL + url.replace(/^\\+|\\+$/g, '') : url.replace(/\\+$/g, ''); // add 'router' if is defined

    var optionsWithRouter = _$1.isNil(router) ? options : _$1.set(_objectSpread2({}, options), routerKey, router); // maybe pick only some keys

    var urlOptions = !_$1.isEmpty(picked) ? _$1.pick(optionsWithRouter, picked) : optionsWithRouter; // convert data to query string for requests without BODY

    if (!_$1.isEmpty(urlOptions)) requestUrl = "".concat(requestUrl, "/?").concat(serializeData(urlOptions, urlOptions.cache));
    return requestUrl;
  }

  function requestURLWithRoot(root, version, url, options) {
    var router = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;
    var picked = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : [];
    var apiBase = "/".concat(root, "/v").concat(version, "/");
    return requestURL(url, options, router, picked, apiBase);
  }

  function requestCustomURL(url, options) {
    var router = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
    var picked = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];
    var apiBase = "/".concat(restBasics.root, "/v").concat(restBasics.version, "/");
    return requestURL(url, options, router, picked, apiBase);
  }

  function setRestRouter(router) {
    restRouter = _$1.isString(router) ? router : _$1.get(router, 'rest.router', null) || _$1.get(router, 'router', null);
  }
  function setRestBasics(data) {
    if (_$1.isNil(data)) return {
      restBasics: restBasics,
      restRouter: restRouter
    };
    restRouter = _$1.get(data, 'rest.router', null) || _$1.get(data, 'router', null);
    restBasics = _$1.get(data, 'rest', restDefaults);
  } // create GET API Promise with Route and Options, then execute it and process results with callbacks

  function fetchAndCatchWithOptions(_ref4) {
    var route = _ref4.route,
        options = _ref4.options,
        picked = _ref4.picked,
        onSuccess = _ref4.onSuccess,
        onError = _ref4.onError;
    apiFetch$1({
      path: requestURL(route, options, picked)
    }).then(function (data) {
      if (_$1.isFunction(onSuccess)) onSuccess(data);
    }).catch(function (error) {
      if (_$1.isFunction(onError)) onError(error);
    });
  } // create POST API Promise with Route and Options, then execute it and process results with callbacks

  function postAndCatchWithOptions(_ref5) {
    var route = _ref5.route,
        options = _ref5.options,
        picked = _ref5.picked,
        onSuccess = _ref5.onSuccess,
        onError = _ref5.onError,
        router = _ref5.router;
    var method = 'POST';
    var postRouter = router || restRouter;

    var requestOptions = _objectSpread2(_objectSpread2({}, options), {}, {
      router: postRouter
    });

    apiFetch$1({
      path: requestURL(route),
      method: method,
      data: !_$1.isEmpty(picked) ? _$1.pick(requestOptions, picked) : requestOptions
    }).then(function (data) {
      if (_$1.isFunction(onSuccess)) onSuccess(data);
    }).catch(function (error) {
      if (_$1.isFunction(onError)) onError(error);
    });
  } // Subset of functions for 'zukit-blocks'

  var blocksSet$1 = {
    serializeData: serializeData,
    setRestBasics: setRestBasics,
    requestURL: requestURLWithRoot,
    restRequestURL: requestCustomURL,
    fetchAndCatchWithOptions: fetchAndCatchWithOptions,
    postAndCatchWithOptions: postAndCatchWithOptions
  };

  var fetch = /*#__PURE__*/Object.freeze({
    __proto__: null,
    ajaxDoAction: ajaxDoAction,
    ajaxUpdateOptions: ajaxUpdateOptions,
    requestURL: requestURL,
    setRestRouter: setRestRouter,
    setRestBasics: setRestBasics,
    fetchAndCatchWithOptions: fetchAndCatchWithOptions,
    postAndCatchWithOptions: postAndCatchWithOptions,
    blocksSet: blocksSet$1
  });

  // WordPress dependencies
  var _lodash$h = lodash,
      forEach$5 = _lodash$h.forEach,
      set$2 = _lodash$h.set,
      unset = _lodash$h.unset,
      isPlainObject$4 = _lodash$h.isPlainObject,
      isFunction$3 = _lodash$h.isFunction,
      keys$2 = _lodash$h.keys,
      castArray$2 = _lodash$h.castArray,
      reduce$2 = _lodash$h.reduce;
  var _wp$element$a = wp.element,
      useCallback$7 = _wp$element$a.useCallback,
      useReducer$1 = _wp$element$a.useReducer,
      useRef$1 = _wp$element$a.useRef; // Internal dependencies

  function optionsReducer(options, action) {
    switch (action.type) {
      case 'set':
        // payload -> update object { key: value, key2: value2 }
        // use the 'set' instead of a simple assignment, because 'key' can be 'path'
        // if 'value' is 'null' then we remove the property at 'path' of object
        forEach$5(action.payload, function (val, key) {
          return val === null ? unset(options, key) : set$2(options, key, val);
        }); // we can't just return 'options' with changes, we must return a new object

        return _objectSpread2({}, options);

      case 'pre-reset':
        // payload -> callback function
        if (isFunction$3(action.payload)) action.payload(options);
        return options;

      case 'reset':
        // payload -> new options object
        return action.payload;

      default:
        return options;
    }
  } // Update 'options' atributte
  // Create callback to pass down a 'dispatch' function from 'useReducer' via context


  function useOptions(initialOptions, createNotice) {
    var _useReducer = useReducer$1(optionsReducer, initialOptions),
        _useReducer2 = _slicedToArray(_useReducer, 2),
        options = _useReducer2[0],
        dispatch = _useReducer2[1];

    var hooks = useRef$1(null);
    var updateOptions = useCallback$7(function (update) {
      var reset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
      var afterUpdateCallback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
      if (!isPlainObject$4(update)) return;

      if (reset) {
        // forced to use the callback trick to get the current 'options'
        dispatch({
          type: 'pre-reset',
          payload: function payload(prevOptions) {
            ajaxUpdateOptions(null, {
              prev: prevOptions,
              next: update
            }, null, hooks.current, afterUpdateCallback);
            dispatch({
              type: 'reset',
              payload: update
            });
          }
        });
      } else {
        ajaxUpdateOptions(keys$2(update), update, createNotice, hooks.current, afterUpdateCallback);
        dispatch({
          type: 'set',
          payload: update
        });
      }
    }, [createNotice]);
    var setUpdateHook = useCallback$7(function (key, callback) {
      var keys = castArray$2(key); // create object for all keys {key: callback}

      var callbacks = reduce$2(keys, function (acc, val) {
        return acc[val] = callback, acc;
      }, {});
      hooks.current = _objectSpread2(_objectSpread2({}, hooks.current || {}), callbacks);
    }, []);
    return [options, updateOptions, setUpdateHook];
  }

  // WordPress dependencies
  var _lodash$g = lodash,
      forEach$4 = _lodash$g.forEach,
      get$6 = _lodash$g.get,
      set$1 = _lodash$g.set,
      isPlainObject$3 = _lodash$g.isPlainObject,
      isFunction$2 = _lodash$g.isFunction,
      mapValues = _lodash$g.mapValues;
  var _wp$element$9 = wp.element,
      createContext$1 = _wp$element$9.createContext,
      useContext = _wp$element$9.useContext,
      useCallback$6 = _wp$element$9.useCallback,
      useReducer = _wp$element$9.useReducer; // Internal dependencies
  // Context and reducer to be used for passing 'getPanel' callback down to component tree
  // The identity of the 'dispatch' function from 'useReducer' is always stable!

  var PanelsContext = createContext$1();
  PanelsContext.displayName = 'ZukitPanelsContext';
  function usePanelsContext() {
    return useContext(PanelsContext);
  }

  function panelsReducer(panels, action) {
    switch (action.type) {
      case 'set':
        // payload -> update object { key: value, key2: value2 }
        // callback -> callback function(panels)
        // используем функцию 'set' чтобы поменять только 'value', а не весь объект
        forEach$4(action.payload, function (value, key) {
          return set$1(panels, "".concat(key, ".value"), value);
        });
        if (isFunction$2(action.callback)) action.callback(panels); // we can't just return 'panels' with changes, we must return a new object

        return _objectSpread2({}, panels);

      default:
        return panels;
    }
  } // Update 'panels' atributte
  // Create callback to pass down a 'dispatch' function from 'useReducer' via context


  function usePanels(initialPanels, createNotice) {
    var _useReducer = useReducer(panelsReducer, initialPanels),
        _useReducer2 = _slicedToArray(_useReducer, 2),
        panels = _useReducer2[0],
        dispatch = _useReducer2[1];

    var setPanel = useCallback$6(function (update) {
      if (!isPlainObject$3(update)) return; // forced to use the callback trick to get the current 'panels'
      // we want 'updatePanels' to be independent of changes in 'panels'

      dispatch({
        type: 'set',
        payload: update,
        callback: function callback(panels) {
          return (// не используем функцию 'updateOptions' чтобы не вызывать не нужное обновление 'options'
            // что приведет к излишним renders - нам нужно только сохранить 'panels' в базе
            ajaxUpdateOptions('panels', mapValues(panels, function (p) {
              return p.value;
            }), createNotice)
          );
        }
      });
    }, [createNotice]);
    var getPanel = useCallback$6(function (action) {
      if (action === undefined) action = {
        type: 'all'
      };

      switch (action.type) {
        case 'all':
          return panels;

        case 'hidden':
          return action.id !== undefined && !get$6(panels, "".concat(action.id, ".value"));

        case 'value':
          return get$6(panels, "".concat(action.id, ".value"));

        case 'title':
          return get$6(panels, "".concat(action.id, ".label"));

        case 'falsely':
          return !checkDependency(get$6(panels, action.id), action.options);

        default:
          return panels;
      }
    }, [panels]);
    return [getPanel, setPanel, PanelsContext];
  }

  // WordPress dependencies
  var _wp$element$8 = wp.element;
      _wp$element$8.useContext;
      var createContext = _wp$element$8.createContext;
  var createHigherOrderComponent$1 = wp.compose.createHigherOrderComponent; // Context to make Notices be accessible by many components in the tree,
  // and at different nesting levels

  var NoticesContext = createContext();
  NoticesContext.displayName = 'ZukitNoticesContext';
  var withNoticesContext = createHigherOrderComponent$1(function (WrappedComponent) {
    return function (props) {
      return /*#__PURE__*/React.createElement(NoticesContext.Consumer, null, function (context) {
        return /*#__PURE__*/React.createElement(WrappedComponent, _extends({
          noticeOperations: context
        }, props));
      });
    };
  }, 'withZukitNoticesContext');

  // WordPress dependencies
  var _wp$components$a = wp.components,
      PanelRow$1 = _wp$components$a.PanelRow,
      Button$6 = _wp$components$a.Button,
      Spinner$2 = _wp$components$a.Spinner;
  var forwardRef = wp.element.forwardRef; // Internal dependencies

  var ZukitActionButton = function ZukitActionButton(_ref, ref) {
    var _mergeClasses;

    var className = _ref.className,
        isLoading = _ref.isLoading,
        icon = _ref.icon,
        color = _ref.color,
        label = _ref.label,
        help = _ref.help,
        value = _ref.value,
        _onClick = _ref.onClick;
    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(PanelRow$1, null, /*#__PURE__*/React.createElement(Button$6, {
      className: mergeClasses('__plugin_actions', (_mergeClasses = {}, _defineProperty(_mergeClasses, color, color), _defineProperty(_mergeClasses, 'is-loading', isLoading), _mergeClasses), className),
      icon: icon,
      isSecondary: true,
      onClick: function onClick() {
        return _onClick(value);
      },
      ref: ref
    }, label, isLoading && /*#__PURE__*/React.createElement(Spinner$2, null))), help && /*#__PURE__*/React.createElement("p", {
      className: mergeClasses('__help', _defineProperty({}, color, color))
    }, simpleMarkdown(help, {
      br: true
    })));
  };

  var ForwardButton = forwardRef(ZukitActionButton);

  // WordPress dependencies
  var _lodash$f = lodash,
      get$5 = _lodash$f.get,
      map$5 = _lodash$f.map,
      isEmpty$5 = _lodash$f.isEmpty,
      isNil$6 = _lodash$f.isNil,
      omitBy = _lodash$f.omitBy,
      pickBy = _lodash$f.pickBy,
      some = _lodash$f.some;
  var __$7 = wp.i18n.__;
  var useCallback$5 = wp.element.useCallback;
  var _wp$components$9 = wp.components,
      createSlotFill = _wp$components$9.createSlotFill,
      PanelBody$1 = _wp$components$9.PanelBody,
      PanelRow = _wp$components$9.PanelRow,
      Button$5 = _wp$components$9.Button,
      ExternalLink$1 = _wp$components$9.ExternalLink,
      ToggleControl$2 = _wp$components$9.ToggleControl,
      Spinner$1 = _wp$components$9.Spinner; // Internal dependencies

  function availablePanels(panels, options) {
    return pickBy(panels, function (p) {
      return checkDependency(p, options);
    });
  }

  var _createSlotFill = createSlotFill('ZukitMoreActions'),
      Fill = _createSlotFill.Fill,
      MoreActionsSlot = _createSlotFill.Slot;

  var ZukitSidebar = function ZukitSidebar(_ref) {
    var version = _ref.version,
        title = _ref.title,
        author = _ref.author,
        link = _ref.link,
        description = _ref.description,
        _ref$icon = _ref.icon,
        icon = _ref$icon === void 0 ? null : _ref$icon,
        more = _ref.more,
        actions = _ref.actions,
        actionLoading = _ref.actionLoading,
        debug = _ref.debug,
        ajaxAction = _ref.ajaxAction,
        options = _ref.options,
        updateOptions = _ref.updateOptions,
        getPanel = _ref.getPanel,
        setPanel = _ref.setPanel;
    var panels = availablePanels(getPanel(), options);
    var moreItems = omitBy(more, function (item) {
      return isNil$6(item) || get$5(item, 'value', null) === null;
    });
    var pluginActions = pickBy(omitBy(actions, isNil$6), function (action) {
      return checkDependency(action, options);
    });
    var hasMoreItems = !isEmpty$5(moreItems); // either we have actions to display or there is an indication that the 'ZukitMoreActions' slot will be used

    var hasActions = !isEmpty$5(pluginActions) || some(actions, ['hasMoreActions', true]);
    var hasPanels = !isEmpty$5(panels);
    var debugSet = get$5(debug, 'prefix', null);
    var debugOptions = debugSet ? get$5(debug, 'options') : null;
    var debugActions = debugSet ? omitBy(get$5(debug, 'actions'), isNil$6) : null;
    var hasDebug = (!isEmpty$5(debugActions) || !isEmpty$5(debugOptions)) && get$5(panels, "".concat(debugSet, ".value")) === true;

    var debugValue = function debugValue(k) {
      return get$5(options, debugSet ? "".concat(debugSet, ".").concat(k) : k);
    };

    var toggleDebugOptions = useCallback$5(function (key) {
      updateOptions(_defineProperty({}, "".concat(debugSet, ".").concat(key), !get$5(options, "".concat(debugSet, ".").concat(key))));
    }, [debugSet, options, updateOptions]);
    var resetAllOptions = useCallback$5(function () {
      ajaxAction('reset_options', function (options) {
        return updateOptions(options, true);
      });
    }, [ajaxAction, updateOptions]);
    return /*#__PURE__*/React.createElement("div", {
      className: "block-editor-block-inspector"
    }, /*#__PURE__*/React.createElement("div", {
      className: "block-editor-block-card"
    }, icon, /*#__PURE__*/React.createElement("div", {
      className: "block-editor-block-card__content"
    }, /*#__PURE__*/React.createElement("h2", {
      className: "block-editor-block-card__title"
    }, title), /*#__PURE__*/React.createElement("span", {
      className: "block-editor-block-card__description __zu_markdown"
    }, simpleMarkdown(description, {
      br: true,
      json: true
    })))), /*#__PURE__*/React.createElement(PanelBody$1, {
      title: __$7('Plugin Info', 'zukit'),
      className: "__plugin_info",
      initialOpen: false
    }, /*#__PURE__*/React.createElement(PanelRow, null, /*#__PURE__*/React.createElement("span", null, __$7('Version', 'zukit')), /*#__PURE__*/React.createElement("span", null, version)), /*#__PURE__*/React.createElement(PanelRow, null, /*#__PURE__*/React.createElement("span", null, __$7('Author', 'zukit')), /*#__PURE__*/React.createElement(ExternalLink$1, {
      href: link
    }, author)), hasMoreItems && map$5(moreItems, function (_ref2, moreKey) {
      var label = _ref2.label,
          value = _ref2.value,
          link = _ref2.link;
      return /*#__PURE__*/React.createElement(PanelRow, {
        key: moreKey
      }, /*#__PURE__*/React.createElement("span", null, label), link ? /*#__PURE__*/React.createElement(ExternalLink$1, {
        href: link
      }, value) : /*#__PURE__*/React.createElement("span", {
        className: "__zu_markdown"
      }, simpleMarkdown(value, {
        br: true,
        json: true
      })));
    }), /*#__PURE__*/React.createElement(PanelRow, null, /*#__PURE__*/React.createElement(Button$5, {
      className: "__plugin_actions admin-blue",
      icon: 'admin-settings',
      isSecondary: true,
      onClick: resetAllOptions
    }, __$7('Reset Plugin Options', 'zukit')))), hasActions && /*#__PURE__*/React.createElement(PanelBody$1, {
      title: __$7('Actions', 'zukit'),
      initialOpen: true
    }, map$5(pluginActions, function (_ref3, actionKey) {
      var label = _ref3.label,
          value = _ref3.value,
          icon = _ref3.icon,
          color = _ref3.color,
          help = _ref3.help;
      return /*#__PURE__*/React.createElement(ForwardButton, {
        key: actionKey,
        icon: icon,
        color: color,
        label: label,
        help: help,
        value: value,
        isLoading: get$5(actionLoading, value),
        onClick: ajaxAction
      });
    }), /*#__PURE__*/React.createElement(MoreActionsSlot, null)), hasPanels && /*#__PURE__*/React.createElement(PanelBody$1, {
      title: __$7('Screen Options', 'zukit'),
      initialOpen: false
    }, map$5(panels, function (_ref4, panelKey) {
      var label = _ref4.label,
          value = _ref4.value,
          help = _ref4.help;
      return /*#__PURE__*/React.createElement(ToggleControl$2, {
        key: panelKey,
        label: label,
        help: help,
        checked: value,
        onChange: function onChange() {
          return setPanel(_defineProperty({}, panelKey, !value));
        }
      });
    })), hasDebug && /*#__PURE__*/React.createElement(PanelBody$1, {
      title: getPanel({
        type: 'title',
        id: debugSet
      }),
      initialOpen: false
    }, map$5(debugOptions, function (_ref5, key) {
      var label = _ref5.label,
          help = _ref5.help;
      return /*#__PURE__*/React.createElement(ToggleControl$2, {
        key: key,
        label: label,
        help: help,
        checked: !!debugValue(key),
        onChange: function onChange() {
          return toggleDebugOptions(key);
        }
      });
    }), map$5(debugActions, function (_ref6, actionKey) {
      var _mergeClasses;

      var label = _ref6.label,
          value = _ref6.value,
          icon = _ref6.icon,
          color = _ref6.color;
      return /*#__PURE__*/React.createElement(PanelRow, {
        key: actionKey
      }, /*#__PURE__*/React.createElement(Button$5, {
        className: mergeClasses('__plugin_actions', (_mergeClasses = {}, _defineProperty(_mergeClasses, color, color), _defineProperty(_mergeClasses, 'is-loading', get$5(actionLoading, value)), _mergeClasses)),
        icon: icon,
        isSecondary: true,
        onClick: function onClick() {
          return ajaxAction(value);
        }
      }, label, get$5(actionLoading, value) && /*#__PURE__*/React.createElement(Spinner$1, null)));
    })));
  };

  ZukitSidebar.MoreActions = Fill;
  ZukitSidebar.ActionButton = ForwardButton;

  var _excluded$5 = ["id", "wp", "edit", "options", "panels", "info", "actions", "debug", "noticeUI", "noticeOperations"];
  // WordPress dependencies
  var _lodash$e = lodash,
      keys$1 = _lodash$e.keys,
      has$3 = _lodash$e.has,
      get$4 = _lodash$e.get,
      includes$4 = _lodash$e.includes,
      isEmpty$4 = _lodash$e.isEmpty,
      forEach$3 = _lodash$e.forEach,
      omit$1 = _lodash$e.omit,
      reduce$1 = _lodash$e.reduce,
      first = _lodash$e.first,
      castArray$1 = _lodash$e.castArray;
  var __$6 = wp.i18n.__;
  var compose$1 = wp.compose.compose;
  var RawHTML$3 = wp.element.RawHTML;
  var BlockIcon$1 = wp.blockEditor.BlockIcon;
  var _wp$components$8 = wp.components,
      withNotices = _wp$components$8.withNotices,
      SlotFillProvider = _wp$components$8.SlotFillProvider;
  var _wp$element$7 = wp.element,
      useState$4 = _wp$element$7.useState,
      useCallback$4 = _wp$element$7.useCallback,
      useEffect$4 = _wp$element$7.useEffect,
      useMemo$1 = _wp$element$7.useMemo; // Internal dependencies
  // 	skeleton: 'block-editor-editor-skeleton',
  // 	body: 'block-editor-editor-skeleton__body',
  // 	content: 'block-editor-editor-skeleton__content',
  // 	sidebar: 'block-editor-editor-skeleton__sidebar',
  // };
  //
  // const editorClasses55 = {
  // 	skeleton: 'interface-interface-skeleton',
  // 	body: 'interface-interface-skeleton__body',
  // 	content: 'interface-interface-skeleton__content',
  // 	sidebar: 'interface-interface-skeleton__sidebar',
  // };

  function editorClasses(element) {
    var more = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
    var wp = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
    var layout = 'edit-post-layout is-mode-visual is-sidebar-opened';
    var prefix50 = 'block-editor-editor-skeleton';
    var prefix55 = 'interface-interface-skeleton';
    var prefixZu = 'zukit-skeleton';
    var classes = "".concat(prefix50, "__").concat(element, " ").concat(prefix55, "__").concat(element, " ").concat(prefixZu, "__").concat(element);

    if (isEmpty$4(element)) {
      var ver = isEmpty$4(wp) ? '' : wp.replace(/\./g, '_');
      var v2digs = 'wp_' + ver.replace(/(\d+_\d+)_\d+/g, '$1');
      var verClass = "wp_".concat(ver).concat(ver !== v2digs ? ' ' + v2digs : '') + (compareVersions(wp, '5.4') < 0 ? ' wp_less_5_4' : '');
      classes = "".concat(verClass, " ").concat(prefix50, " ").concat(prefix55, " ").concat(prefixZu, " ").concat(layout);
    } else if (element === 'editor') classes = "".concat(prefixZu, "__").concat(element);

    return "".concat(classes, " ").concat(more).trim();
  } // Zukit Skeleton Component


  var cprefix$2 = 'zukit-skeleton';

  var ZukitSkeleton = function ZukitSkeleton(_ref) {
    var id = _ref.id,
        wp = _ref.wp,
        EditComponent = _ref.edit,
        _ref$options = _ref.options,
        initialOptions = _ref$options === void 0 ? {} : _ref$options,
        _ref$panels = _ref.panels,
        initialPanels = _ref$panels === void 0 ? {} : _ref$panels,
        _ref$info = _ref.info,
        info = _ref$info === void 0 ? {} : _ref$info,
        actions = _ref.actions,
        debug = _ref.debug,
        noticeUI = _ref.noticeUI,
        _ref$noticeOperations = _ref.noticeOperations,
        noticeOperations = _ref$noticeOperations === void 0 ? {} : _ref$noticeOperations,
        moreParams = _objectWithoutProperties(_ref, _excluded$5);

    var createNotice = noticeOperations.createNotice;

    var _useState = useState$4(info.more || {}),
        _useState2 = _slicedToArray(_useState, 2),
        moreInfo = _useState2[0],
        setMoreInfo = _useState2[1];

    var _useState3 = useState$4( // create object {action_value: state} from 'actions'
    reduce$1(actions, function (acc, val) {
      return acc[val.value] = false, acc;
    }, // from 'debug.actions'
    reduce$1(debug.actions, function (acc, val) {
      return acc[val.value] = false, acc;
    }, {}))),
        _useState4 = _slicedToArray(_useState3, 2),
        loading = _useState4[0],
        setLoading = _useState4[1];

    var updateLoading = useCallback$4(function (update) {
      var updateKey = first(keys$1(update)); // update only if we have this 'key' in 'loading'

      if (has$3(loading, updateKey)) {
        setLoading(function (prevLoading) {
          return _objectSpread2(_objectSpread2({}, prevLoading || {}), update || {});
        });
      }
    }, [loading]); // create 'options' and setter

    var _useOptions = useOptions(initialOptions, createNotice),
        _useOptions2 = _slicedToArray(_useOptions, 3),
        options = _useOptions2[0],
        updateOptions = _useOptions2[1],
        setUpdateHook = _useOptions2[2]; // create getter and setter for 'panels'


    var _usePanels = usePanels(initialPanels, createNotice),
        _usePanels2 = _slicedToArray(_usePanels, 3),
        getPanel = _usePanels2[0],
        setPanel = _usePanels2[1],
        PanelsContext = _usePanels2[2]; // function that allows you to selectively reset options to their original values
    // first get all initial values through 'ajaxAction', and then create an object with updates
    // and calls 'updateOptions'. Accepts an array of keys (or one key as string) as an argument
    // and 'afterCallback', which will be called after the options are updated


    var resetOptions = useCallback$4(function (toBeReset) {
      var afterCallback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      ajaxAction('default_options', function (options) {
        var update = reduce$1(castArray$1(toBeReset), function (acc, value) {
          var resetValue = get$4(options, value, null);
          if (resetValue !== null) acc[value] = resetValue;
          return acc;
        }, {});
        updateOptions(update, false, afterCallback);
      });
    }, [ajaxAction, updateOptions]);
    var ajaxAction = useCallback$4(function (params, callback) {
      ajaxDoAction(params, callback, createNotice, updateLoading);
    }, [createNotice, updateLoading]); // set hooks to update info.more items when dependency keys (in 'depends') are updated in 'options'

    useEffect$4(function () {
      var infoKeys = reduce$1(moreInfo, function (acc, value) {
        forEach$3(castArray$1(get$4(value, 'depends', [])), function (val) {
          return includes$4(acc, val) ? null : acc.push(val);
        });
        return acc;
      }, []);
      setUpdateHook(infoKeys, function () {
        ajaxAction('zukit_more_info', function (infoData) {
          setMoreInfo(get$4(infoData, 'more', {}));
        });
      });
    }, [moreInfo, setUpdateHook, ajaxAction]); // additional data that was passed to the script from the PHP code
    // they are practically unchanged and therefore we Memoize them

    var moreData = useMemo$1(function () {
      return omit$1(moreParams, ['router', 'noticeList']);
    }, [moreParams]);
    var pluginOptionsEdit = !EditComponent ? null : /*#__PURE__*/React.createElement(NoticesContext.Provider, {
      value: noticeOperations
    }, /*#__PURE__*/React.createElement(PanelsContext.Provider, {
      value: getPanel
    }, /*#__PURE__*/React.createElement(EditComponent, {
      id: id,
      wp: wp,
      info: info,
      title: __$6('General Settings', 'zukit'),
      options: options,
      updateOptions: updateOptions,
      resetOptions: resetOptions,
      ajaxAction: ajaxAction,
      noticeOperations: noticeOperations,
      setUpdateHook: setUpdateHook,
      moreData: moreData
    })));
    var pluginIcon = !info.icon ? null : /*#__PURE__*/React.createElement(BlockIcon$1, {
      icon: /*#__PURE__*/React.createElement(RawHTML$3, null, info.icon),
      showColors: true
    }); // custom appearance

    var backdropColor = get$4(info, 'colors.backdrop');
    var headerColor = get$4(info, 'colors.header');
    var titleColor = get$4(info, 'colors.title');
    return /*#__PURE__*/React.createElement("div", {
      className: editorClasses(null, cprefix$2, wp)
    }, /*#__PURE__*/React.createElement("div", {
      className: editorClasses('body')
    }, /*#__PURE__*/React.createElement(SlotFillProvider, null, /*#__PURE__*/React.createElement("div", {
      className: editorClasses('content'),
      role: "region",
      "aria-label": "Settings content",
      tabIndex: "-1",
      style: backdropColor && {
        backgroundColor: backdropColor
      }
    }, /*#__PURE__*/React.createElement("div", {
      className: "components-editor-notices__dismissible"
    }, noticeUI), /*#__PURE__*/React.createElement("div", {
      className: editorClasses('editor', 'editor-styles-wrapper'),
      tabIndex: "-1"
    }, /*#__PURE__*/React.createElement("div", {
      className: "block-editor-block-list__layout"
    }, /*#__PURE__*/React.createElement("div", {
      className: "wp-block block-editor-block-list__block"
    }, /*#__PURE__*/React.createElement("div", {
      className: "editor-post-title",
      style: headerColor && {
        backgroundColor: headerColor
      }
    }, /*#__PURE__*/React.createElement("div", {
      className: "wp-block editor-post-title__block"
    }, /*#__PURE__*/React.createElement("h1", {
      style: titleColor && {
        color: titleColor
      }
    }, info.title), pluginIcon)), pluginOptionsEdit)))), /*#__PURE__*/React.createElement("div", {
      className: editorClasses('sidebar'),
      role: "region",
      "aria-label": "Plugin settings",
      tabIndex: "-1"
    }, /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
      className: "interface-complementary-area edit-post-sidebar"
    }, /*#__PURE__*/React.createElement(ZukitSidebar, _extends({
      id: id,
      wp: wp,
      icon: pluginIcon,
      more: moreInfo,
      actions: actions,
      actionLoading: loading,
      debug: debug,
      ajaxAction: ajaxAction,
      options: options,
      updateOptions: updateOptions,
      getPanel: getPanel,
      setPanel: setPanel
    }, omit$1(info, ['icon', 'more'])))))))));
  };

  var ZukitSkeleton$1 = compose$1([withNotices])(ZukitSkeleton);

  // WordPress dependencies
  var _lodash$d = lodash,
      includes$3 = _lodash$d.includes; // Internal dependencies

  var defaultUnit = 'em';
  var defaultSize = 2;

  var ZukitDivider = function ZukitDivider(_ref) {
    var className = _ref.className,
        _ref$size = _ref.size,
        size = _ref$size === void 0 ? defaultSize : _ref$size,
        _ref$unit = _ref.unit,
        unit = _ref$unit === void 0 ? defaultUnit : _ref$unit,
        bottomHalf = _ref.bottomHalf;
    var sizeUnit = includes$3(unit, ['px', 'em', 'rem', '%']) ? unit : defaultUnit;
    var sizeValue = toRange(size, 0, 100);
    var style = sizeValue > 0 ? {
      marginBottom: "".concat(bottomHalf ? sizeValue / 2 : sizeValue).concat(sizeUnit),
      paddingTop: "".concat(sizeValue).concat(sizeUnit)
    } : null;
    return /*#__PURE__*/React.createElement("div", {
      className: mergeClasses('zukit-divider', className),
      style: style
    });
  };

  // WordPress dependencies
  var _lodash$c = lodash,
      get$3 = _lodash$c.get,
      set = _lodash$c.set,
      map$4 = _lodash$c.map,
      has$2 = _lodash$c.has,
      forEach$2 = _lodash$c.forEach,
      defaultsDeep = _lodash$c.defaultsDeep;
  var __$5 = wp.i18n.__;
  var _wp$element$6 = wp.element,
      render = _wp$element$6.render,
      Fragment$1 = _wp$element$6.Fragment;
  var _wp$components$7 = wp.components,
      ToggleControl$1 = _wp$components$7.ToggleControl,
      SelectControl = _wp$components$7.SelectControl,
      Button$4 = _wp$components$7.Button; // Internal dependencies
  function externalDataSettings(pageId) {
    return externalData("".concat(pageId, "_settings"));
  }
  function renderPage(pageId) {
    var settings = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    var pageData = externalDataSettings(pageId); // restRouter serves to identify the plugin/theme that currently uses the REST API

    setRestBasics(pageData);

    if (get$3(settings, 'panels') !== undefined) {
      // Get 'debug' options key
      var debugPanelKey = get$3(pageData, 'debug.prefix', null); // Add 'Debug Actions' panel defaults if 'debug' key is found

      if (debugPanelKey !== null) {
        defaultsDeep(settings.panels, _defineProperty({}, debugPanelKey, {
          label: __$5('Debug Plugin', 'zukit'),
          value: false
        }));
      } // Sync 'panels' with saved 'options' if presented


      if (get$3(pageData, 'options.panels') !== undefined) {
        var panels = pageData.options.panels;
        forEach$2(panels, function (value, key) {
          return set(settings, "panels.".concat(key, ".value"), value);
        });
      }
    }

    if (document.getElementById(pageId) !== null) {
      render( /*#__PURE__*/React.createElement(ZukitSkeleton$1, _extends({
        id: pageId
      }, pageData, settings)), document.getElementById(pageId));
    }
  }

  function checkDivider(item) {
    return has$2(item, 'divider') ? true : null;
  }

  function toggleOption(toggleData, options, updateOptions) {
    var withPath = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;

    var fullKey = function fullKey(k) {
      return withPath ? "".concat(withPath, ".").concat(k) : k;
    };

    var optionValue = function optionValue(k) {
      return get$3(options, fullKey(k));
    }; //  withPath ? `${withPath}.${k}` : k


    return map$4(toggleData, function (item, key) {
      return checkDependency(item, options, false, withPath) && /*#__PURE__*/React.createElement(Fragment$1, {
        key: key
      }, checkDivider(item) && /*#__PURE__*/React.createElement(ZukitDivider, {
        size: item.divider
      }), /*#__PURE__*/React.createElement(ToggleControl$1, {
        label: item.label,
        help: simpleMarkdown(item.help, {
          br: true
        }),
        checked: !!optionValue(key),
        onChange: function onChange() {
          return updateOptions(_defineProperty({}, fullKey(key), !optionValue(key)));
        }
      }));
    });
  }
  function selectOption(optionData, options, updateOptions) {
    var withPath = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;
    var _optionData$id = optionData.id,
        id = _optionData$id === void 0 ? '?' : _optionData$id,
        _optionData$options = optionData.options,
        selectOptions = _optionData$options === void 0 ? [] : _optionData$options,
        _optionData$label = optionData.label,
        label = _optionData$label === void 0 ? '' : _optionData$label,
        help = optionData.help,
        defaultValue = optionData.defaultValue;
    var selectId = withPath ? "".concat(withPath, ".").concat(id) : id;
    var value = get$3(options, selectId, defaultValue);
    return checkDependency(optionData, options, false, withPath) && /*#__PURE__*/React.createElement(React.Fragment, null, checkDivider(optionData) && /*#__PURE__*/React.createElement(ZukitDivider, {
      size: optionData.divider
    }), /*#__PURE__*/React.createElement("label", {
      className: "components-base-control__label __select_label",
      htmlFor: id
    }, label), /*#__PURE__*/React.createElement("div", {
      className: "__select_block"
    }, /*#__PURE__*/React.createElement("div", {
      className: "__select_control"
    }, /*#__PURE__*/React.createElement(SelectControl, {
      id: id,
      value: value,
      onChange: function onChange(value) {
        return updateOptions(_defineProperty({}, selectId, value));
      },
      options: selectOptions
    }), defaultValue !== undefined && /*#__PURE__*/React.createElement(Button$4, {
      isSecondary: true,
      className: "__reset",
      onClick: function onClick() {
        return updateOptions(_defineProperty({}, selectId, defaultValue));
      }
    }, __$5('Reset', 'zukit'))), /*#__PURE__*/React.createElement("p", {
      className: "components-base-control__help"
    }, simpleMarkdown(help, {
      br: true
    }))));
  }
  function testComponentWithUpdate(component, updateOptions) {
    var TestComponent = get$3(wp, "zukit.components.".concat(component));
    return !TestComponent ? null : /*#__PURE__*/React.createElement(TestComponent, {
      updateOptions: updateOptions
    });
  } // Subset of functions for 'zukit-blocks'

  var blocksSet = {
    toggleOption: toggleOption,
    selectOption: selectOption
  };

  var render$1 = /*#__PURE__*/Object.freeze({
    __proto__: null,
    externalDataSettings: externalDataSettings,
    renderPage: renderPage,
    toggleOption: toggleOption,
    selectOption: selectOption,
    testComponentWithUpdate: testComponentWithUpdate,
    blocksSet: blocksSet
  });

  // WordPress dependencies
  var _lodash$b = lodash,
      isArray$1 = _lodash$b.isArray,
      isPlainObject$2 = _lodash$b.isPlainObject,
      isNil$5 = _lodash$b.isNil,
      isNaN = _lodash$b.isNaN,
      forEach$1 = _lodash$b.forEach,
      includes$2 = _lodash$b.includes,
      trim$1 = _lodash$b.trim;
  var $ = jQuery; //-----------------------------------------------------------------------------]
  // Remove element classes with wildcard matching. Optionally add classes:
  //     $( '#foo' ).alterClass( 'foo-* bar-*', 'foobar' )
  //
  //  Copyright (c) 2011 Pete Boere (https://gist.github.com/peteboere/1517285)
  //

  $.fn.alterClass = function (removals, additions) {
    var self = this;

    if (!removals || removals.indexOf('*') === -1) {
      // Use native jQuery methods if there is no wildcard matching
      self.removeClass(removals);
      return !additions ? self : self.addClass(additions);
    }

    var patt = new RegExp('\\s' + removals.replace(/\*/g, '[A-Za-z0-9-_]+').split(' ').join('\\s|\\s') + '\\s', 'g');
    self.each(function (_i, it) {
      var cn = ' ' + it.className + ' ';

      while (patt.test(cn)) {
        cn = cn.replace(patt, ' ');
      }

      it.className = trim$1(cn);
    });
    return !additions ? self : self.addClass(additions);
  };

  function toggleBodyClass(className, state) {
    $('body').toggleClass(className, state);
  }
  function alterClassWithClientId(clientId, selector, removals, additions) {
    $("#block-".concat(clientId, " ").concat(selector)).alterClass(removals, additions);
  }
  function findWithClientId(clientId) {
    var selector = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
    var $el = $("#block-".concat(clientId)).find(selector);
    return $el.length ? $el : null;
  } // if we just have a pair of 'prop' and 'value' and if 'value' === undefined then remove the attribute,
  // otherwise, set it to the given 'value'
  // if 'prop' is an array - remove all attributes with props from the array
  // if 'prop' is an object - do 'forEach' for each property and process it
  // as a simple pair of 'prop' and 'value'

  function attrWithClientId(clientId, prop, value) {
    var selector = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';
    var $el = $("#block-".concat(clientId, " ").concat(selector));

    if ($el.length) {
      var processAttr = function processAttr(val, key) {
        return val === undefined ? $el.removeAttr(key) : $el.attr(key, val);
      };

      if (isArray$1(prop)) {
        forEach$1(prop, function (val) {
          return $el.removeAttr(val);
        });
      } else if (isPlainObject$2(prop)) {
        forEach$1(prop, processAttr);
      } else {
        processAttr(value, prop);
      }
    }
  } // get the attribute and try to convert it to an Integer (if requested)

  function getAttrWithClientId(clientId, prop) {
    var selector = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';
    var castInt = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;
    var $el = $("#block-".concat(clientId, " ").concat(selector));

    if ($el.length) {
      var attrValue = $el.attr(prop);

      if (castInt) {
        var intValue = parseInt(attrValue, 10);
        return isNaN(intValue) ? 0 : intValue;
      }

      return attrValue;
    }

    return null;
  } // similar to the previous description

  function cssWithClientId(clientId, prop, value) {
    var selector = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';
    var $el = $("#block-".concat(clientId, " ").concat(selector));

    if ($el.length) {
      var processCss = function processCss(val, key) {
        return val === undefined ? $el.css(key, '') : $el.css(key, val);
      };

      if (isArray$1(prop)) {
        forEach$1(prop, function (val) {
          return $el.css(val, '');
        });
      } else if (isPlainObject$2(prop)) {
        forEach$1(prop, processCss);
      } else {
        processCss(value, prop);
      }
    }
  } // get the CSS value and try to convert it to an Integer (if requested)

  function getCssWithClientId(clientId, prop) {
    var selector = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';
    var castInt = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;
    var $el = $("#block-".concat(clientId, " ").concat(selector));

    if ($el.length) {
      var cssValue = $el.css(prop);

      if (castInt) {
        var intValue = parseInt(cssValue, 10);
        return isNaN(intValue) ? 0 : intValue;
      }

      return cssValue;
    }

    return null;
  }
  var availableSizes = ['width', 'height', 'innerWidth', 'innerHeight', 'outerWidth', 'outerHeight'];
  function sizeWithClientId(clientId, size) {
    var selector = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';
    if (!includes$2(availableSizes, size)) return null;
    var $el = $("#block-".concat(clientId, " ").concat(selector));
    return $el.length ? $el[size]() : null;
  }
  function setInputAndFocus(parent) {
    var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
    var selector = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'input';
    $(parent).find(selector).val(value).trigger('focus');
  }
  function clickButton(parent) {
    var selector = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'button';
    $(parent).find(selector).trigger('click');
  }
  function setAttr(parent, selector, attributes) {
    $(parent).find(selector).attr(attributes);
  }
  function hasSelector(parent, selector) {
    return $(parent).has(selector).length > 0;
  } // Scroll back to the top of scrollable div (by default 'skeleton__content' of Settings Page)

  function scrollTop() {
    var selector = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '.block-editor-editor-skeleton__content';
    document.querySelector(selector).scrollTo({
      top: 0,
      behavior: 'smooth'
    });
  } // Creates a function to observe the DOM mutation and attaches callback to it

  function createMutationObserver(callback) {
    var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;
    var observer = new MutationObserver(callback);
    return observer;
  } // Finds an element by 'selector' and start observing it for the events of mutation.
  // By default observed only 'childList' and its 'subtree'. If en element was not found
  // then 'disconnect' observer.

  function observeMutation(selector, observer) {
    var $node = $(selector);

    if ($node.length === 0 || isNil$5(observer)) {
      observer && observer.disconnect();
      return;
    }

    observer.observe($node[0], {
      childList: true,
      subtree: true,
      attributes: false,
      characterData: false
    });
  }

  var jq = /*#__PURE__*/Object.freeze({
    __proto__: null,
    toggleBodyClass: toggleBodyClass,
    alterClassWithClientId: alterClassWithClientId,
    findWithClientId: findWithClientId,
    attrWithClientId: attrWithClientId,
    getAttrWithClientId: getAttrWithClientId,
    cssWithClientId: cssWithClientId,
    getCssWithClientId: getCssWithClientId,
    sizeWithClientId: sizeWithClientId,
    setInputAndFocus: setInputAndFocus,
    clickButton: clickButton,
    setAttr: setAttr,
    hasSelector: hasSelector,
    scrollTop: scrollTop,
    createMutationObserver: createMutationObserver,
    observeMutation: observeMutation
  });

  // WordPress dependencies
  var _wp$components$6 = wp.components,
      Path = _wp$components$6.Path,
      G = _wp$components$6.G,
      SVG = _wp$components$6.SVG; // Zukit Notice icons

  var warning = /*#__PURE__*/React.createElement(SVG, {
    width: "48",
    height: "48",
    viewBox: "0 0 48 48",
    xmlns: "http://www.w3.org/2000/svg"
  }, /*#__PURE__*/React.createElement(G, null, /*#__PURE__*/React.createElement(G, null, /*#__PURE__*/React.createElement(Path, {
    d: "M3.133,39.53 C2.842,40.09 2.5,40.613 2.5,41.227 L2.503,41.484 C2.503,42.809 3.54,43.611 4.733,43.611 L43.28,43.611 C44.473,43.611 45.5,42.617 45.5,41.292 L45.487,41.034 C45.487,40.42 45.186,39.886 44.855,39.337 L25.765,5.092 C24.921,4.155 23.554,4.155 22.711,5.092 L3.133,39.53 z",
    fill: "#FFD42A"
  }), /*#__PURE__*/React.createElement(Path, {
    d: "M3.133,39.53 C2.842,40.09 2.5,40.613 2.5,41.227 L2.503,41.484 C2.503,42.809 3.54,43.611 4.733,43.611 L43.28,43.611 C44.473,43.611 45.5,42.617 45.5,41.292 L45.487,41.034 C45.487,40.42 45.186,39.886 44.855,39.337 L25.765,5.092 C24.921,4.155 23.554,4.155 22.711,5.092 L3.133,39.53 z",
    fillOpacity: "0",
    stroke: "#998019",
    strokeWidth: "3.111"
  })), /*#__PURE__*/React.createElement(Path, {
    d: "M27.215,36.707 C27.215,38.433 25.816,39.831 24.091,39.831 C22.365,39.831 20.966,38.433 20.966,36.707 C20.966,34.982 22.365,33.583 24.091,33.583 C25.816,33.583 27.215,34.982 27.215,36.707 z M24.07,15 C22.843,15 20.785,15.978 20.785,17.193 L21.855,29.817 C21.855,31.032 22.843,32.01 24.07,32.01 C25.298,32.01 26.286,31.032 26.286,29.817 L27.203,17.193 C27.203,15.978 25.298,15 24.07,15 z",
    fill: "#000000",
    id: "exlamation"
  })));
  var error$1 = /*#__PURE__*/React.createElement(SVG, {
    width: "48",
    height: "48",
    viewBox: "0 0 48 48",
    xmlns: "http://www.w3.org/2000/svg"
  }, /*#__PURE__*/React.createElement(G, null, /*#__PURE__*/React.createElement(G, null, /*#__PURE__*/React.createElement(Path, {
    d: "M24,46 C11.85,46 2,36.15 2,24 C2,11.85 11.85,2 24,2 C36.15,2 46,11.85 46,24 C46,36.15 36.15,46 24,46 z",
    fill: "#FF4136"
  }), /*#__PURE__*/React.createElement(Path, {
    d: "M24,46 C11.85,46 2,36.15 2,24 C2,11.85 11.85,2 24,2 C36.15,2 46,11.85 46,24 C46,36.15 36.15,46 24,46 z",
    fillOpacity: "0",
    stroke: "#B22E27",
    strokeWidth: "3.111"
  })), /*#__PURE__*/React.createElement(Path, {
    d: "M27.655,34.564 C27.655,36.526 26.065,38.116 24.103,38.116 C22.141,38.116 20.551,36.526 20.551,34.564 C20.551,32.602 22.141,31.012 24.103,31.012 C26.065,31.012 27.655,32.602 27.655,34.564 z M24.08,9.884 C22.684,9.884 20.345,10.996 20.345,12.377 L21.561,26.73 C21.561,28.112 22.684,29.223 24.08,29.223 C25.475,29.223 26.599,28.112 26.599,26.73 L27.641,12.377 C27.641,10.996 25.475,9.884 24.08,9.884 z",
    fill: "#FFFFFF",
    id: "exlamation"
  })));
  var info = /*#__PURE__*/React.createElement(SVG, {
    width: "48",
    height: "48",
    viewBox: "0 0 48 48",
    xmlns: "http://www.w3.org/2000/svg"
  }, /*#__PURE__*/React.createElement(G, null, /*#__PURE__*/React.createElement(G, null, /*#__PURE__*/React.createElement(Path, {
    d: "M24,46 C11.85,46 2,36.15 2,24 C2,11.85 11.85,2 24,2 C36.15,2 46,11.85 46,24 C46,36.15 36.15,46 24,46 z",
    fill: "#00ACED"
  }), /*#__PURE__*/React.createElement(Path, {
    d: "M24,46 C11.85,46 2,36.15 2,24 C2,11.85 11.85,2 24,2 C36.15,2 46,11.85 46,24 C46,36.15 36.15,46 24,46 z",
    fillOpacity: "0",
    stroke: "#0082B2",
    strokeWidth: "3.111"
  })), /*#__PURE__*/React.createElement(Path, {
    d: "M24.896,18.828 L27.094,18.828 L27.094,35.322 L27.574,35.802 L29.883,35.987 L29.883,38 L18.117,38 L18.117,35.987 L20.352,35.802 L20.777,35.322 L20.777,22.873 L18.339,22.873 L18.339,21.008 z M20.5,13.528 Q20.5,11.958 21.47,10.979 Q22.439,10 23.991,10 Q25.468,10 26.466,10.97 Q27.463,11.939 27.463,13.343 Q27.463,14.931 26.456,15.947 Q25.45,16.963 23.917,16.963 Q22.476,16.963 21.488,15.975 Q20.5,14.987 20.5,13.528 z",
    fill: "#FFFFFF",
    id: "info"
  })));
  var image = /*#__PURE__*/React.createElement(SVG, {
    width: "24",
    height: "24",
    viewBox: "0 0 24 24",
    xmlns: "http://www.w3.org/2000/svg"
  }, /*#__PURE__*/React.createElement(Path, {
    d: "M8.5,6.999 C9.881,6.999 11,8.118 11,9.499 C11,10.88 9.881,11.999 8.5,11.999 C7.119,11.999 6,10.88 6,9.499 C6,8.118 7.119,6.999 8.5,6.999 z M16,10.999 C18,10.999 19,16.999 19,16.999 L4.999,16.999 C4.999,16.999 6,12.999 8,12.999 C10.001,12.999 10,13.999 11.5,13.999 C13,13.999 14,10.999 16,10.999 z M16,11.999 C15.37,11.999 14.779,12.646 14.152,13.333 C13.441,14.114 12.637,14.999 11.499,14.999 C10.535,14.999 9.976,14.677 9.529,14.419 C9.124,14.184 8.805,13.999 7.999,13.999 C7.442,13.999 6.821,14.966 6.387,16 L17.779,16 C17.27,13.803 16.45,12.05 16,11.999 M20,18 L20.003,6 L4,6 L4,18 L20,18 z M22,6 L22,18 C22,19.104 21.104,20 20,20 L4,20 C2.896,20 2,19.104 2,18 L2,6 C2,4.896 2.896,4 4,4 L20,4 C21.104,4 22,4.896 22,6 z"
  }));
  var close = /*#__PURE__*/React.createElement(SVG, {
    width: "20",
    height: "20",
    viewBox: "0 0 20 20",
    xmlns: "http://www.w3.org/2000/svg"
  }, /*#__PURE__*/React.createElement(Path, {
    d: "M14.95 6.46L11.41 10l3.54 3.54-1.41 1.41L10 11.42l-3.53 3.53-1.42-1.42L8.58 10 5.05 6.47l1.42-1.42L10 8.58l3.54-3.53z"
  }));

  var icons = /*#__PURE__*/Object.freeze({
    __proto__: null,
    warning: warning,
    error: error$1,
    info: info,
    image: image,
    close: close
  });

  var _excluded$4 = ["id", "className", "title", "children", "options"];
  // WordPress dependencies
  var PanelBody = wp.components.PanelBody; // Internal dependencies

  var ZukitPanel = function ZukitPanel(_ref) {
    var id = _ref.id,
        className = _ref.className,
        title = _ref.title,
        children = _ref.children,
        _ref$options = _ref.options,
        options = _ref$options === void 0 ? {} : _ref$options,
        props = _objectWithoutProperties(_ref, _excluded$4);

    var getPanel = usePanelsContext();
    if (getPanel({
      type: 'hidden',
      id: id
    })) return null;
    if (getPanel({
      type: 'falsely',
      id: id,
      options: options
    })) return null;
    return /*#__PURE__*/React.createElement(PanelBody, _extends({
      title: getPanel({
        type: 'title',
        id: id
      }) || title,
      className: mergeClasses('zukit-panel', className)
    }, props), children);
  };

  // WordPress dependencies
  var _lodash$a = lodash,
      map$3 = _lodash$a.map,
      get$2 = _lodash$a.get,
      isEmpty$3 = _lodash$a.isEmpty,
      isNil$4 = _lodash$a.isNil,
      isPlainObject$1 = _lodash$a.isPlainObject,
      forEach = _lodash$a.forEach,
      noop = _lodash$a.noop;
  var _wp$element$5 = wp.element,
      RawHTML$2 = _wp$element$5.RawHTML,
      useState$3 = _wp$element$5.useState,
      useCallback$3 = _wp$element$5.useCallback,
      useEffect$3 = _wp$element$5.useEffect;
  var _wp$components$5 = wp.components,
      Spinner = _wp$components$5.Spinner,
      Tooltip$3 = _wp$components$5.Tooltip,
      ExternalLink = _wp$components$5.ExternalLink;
  var BlockIcon = wp.blockEditor.BlockIcon; // Internal dependencies

  var getRowStyles = function getRowStyles(index, colors) {
    var borderOpacity = 0.3;
    var headBorderOpacity = 0.6;
    var oddOpacity = 0.4;
    var isEven = index % 2 == 0;
    var backdrop = colors.backdrop,
        header = colors.header,
        title = colors.title;
    return index === 'table' ? {
      borderBottomColor: hexToRGBA(title, borderOpacity)
    } : index === 'head' ? {
      backgroundColor: header,
      borderColor: hexToRGBA(title, headBorderOpacity)
    } : {
      color: title,
      backgroundColor: isEven ? backdrop : hexToRGBA(header, oddOpacity),
      borderBottomColor: hexToRGBA(title, borderOpacity)
    };
  };

  var makeRef = function makeRef(row, id) {
    return "".concat(row, ":").concat(id);
  }; // Zukit Table Component


  var ZukitTable = function ZukitTable(_ref) {
    var className = _ref.className,
        fixed = _ref.fixed,
        config = _ref.config,
        head = _ref.head,
        body = _ref.body,
        loading = _ref.loading,
        _ref$onDynamic = _ref.onDynamic,
        onDynamic = _ref$onDynamic === void 0 ? noop : _ref$onDynamic,
        dynamicCells = _ref.dynamic;
    // check if there are dynamic cells and call the parent handler if any
    useEffect$3(function () {
      if (isEmpty$3(dynamicCells)) {
        forEach(body, function (cells, row) {
          forEach(cells, function (cellData, cell) {
            var dynamic = get$2(cellData, ['params', 'dynamic']);
            var id = get$2(dynamic, 'id');
            if (dynamic) onDynamic(_objectSpread2({
              row: row,
              cell: cell,
              ref: makeRef(row, id)
            }, dynamic));
          });
        });
      }
    }, [body, onDynamic, dynamicCells]);

    var _ref2 = config || {},
        _ref2$align = _ref2.align,
        cellAlign = _ref2$align === void 0 ? [] : _ref2$align,
        _ref2$style = _ref2.style,
        cellStyle = _ref2$style === void 0 ? [] : _ref2$style,
        _ref2$className = _ref2.className,
        cellClass = _ref2$className === void 0 ? [] : _ref2$className;

    var colors = getExternalData('info.colors', {});

    var processDynamic = function processDynamic(row, kind, dynamicParams) {
      var content = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;
      // process dynamic cells, if value is 'undefined' then request it from the parent
      var id = get$2(dynamicParams, 'id');
      return id ? get$2(dynamicCells, [makeRef(row, id), kind], content) : undefined;
    };

    var withContent = function withContent(rowIndex, content, params) {
      if (isPlainObject$1(content)) {
        var dashicon = content.dashicon,
            svg = content.svg,
            tooltip = content.tooltip;
        var icon = /*#__PURE__*/React.createElement(BlockIcon, {
          icon: svg ? /*#__PURE__*/React.createElement(RawHTML$2, null, svg) : dashicon,
          showColors: true
        });
        return !tooltip ? icon : /*#__PURE__*/React.createElement(Tooltip$3, {
          text: tooltip
        }, /*#__PURE__*/React.createElement("div", null, icon));
      } else {
        var _ref3 = params || {},
            _ref3$markdown = _ref3.markdown,
            markdown = _ref3$markdown === void 0 ? false : _ref3$markdown,
            link = _ref3.link,
            dynamic = _ref3.dynamic;

        if (markdown) return simpleMarkdown(content, {
          br: true,
          json: true
        });

        if (get$2(link, 'href')) {
          var title = link.title,
              href = link.href;
          return /*#__PURE__*/React.createElement(ExternalLink, {
            href: href
          }, title);
        } // process dynamic cells, if null then show <Spinner/>


        var dynamicValue = processDynamic(rowIndex, 'content', dynamic, content);

        if (dynamicValue !== undefined) {
          if (dynamicValue === null) return /*#__PURE__*/React.createElement(Spinner, null);

          var _ref4 = dynamic || {},
              _ref4$markdown = _ref4.markdown,
              asMarkdown = _ref4$markdown === void 0 ? false : _ref4$markdown;

          return asMarkdown ? simpleMarkdown(dynamicValue, {
            br: true,
            json: true
          }) : dynamicValue;
        }

        return content;
      }
    };

    var withStyle = function withStyle(index, style) {
      var commonStyle = get$2(cellStyle, index);
      if (isNil$4(style) && !commonStyle) return null;
      return _objectSpread2(_objectSpread2({}, commonStyle || {}), style || {});
    };

    var withClass = function withClass(rowIndex, cellIndex, align, params) {
      var _ref6;

      var commonClass = get$2(cellClass, cellIndex);
      var commonAlign = align || get$2(cellAlign, cellIndex) || 'left';

      var _ref5 = params || {},
          additionalСlassName = _ref5.className,
          dynamic = _ref5.dynamic;

      var dynamicClassName = processDynamic(rowIndex, 'className', dynamic);
      return _ref6 = {}, _defineProperty(_ref6, commonClass || '', commonClass), _defineProperty(_ref6, "has-text-align-".concat(commonAlign), commonAlign), _defineProperty(_ref6, '__zu_markdown', get$2(params, 'markdown') || get$2(dynamic, 'markdown')), _defineProperty(_ref6, '__zu_link', get$2(params, 'link.href')), _defineProperty(_ref6, additionalСlassName, additionalСlassName), _defineProperty(_ref6, dynamicClassName, dynamicClassName), _ref6;
    };

    var hasHead = !isEmpty$3(head);
    var hasRows = !isEmpty$3(body);
    return /*#__PURE__*/React.createElement("div", {
      className: mergeClasses('zukit-table', className, {
        'has-fixed-layout': fixed,
        'is-loading': loading
      }),
      style: getRowStyles('table', colors)
    }, hasHead && /*#__PURE__*/React.createElement("div", {
      className: "head",
      style: getRowStyles('head', colors)
    }, map$3(head, function (_ref7, cellIndex) {
      var content = _ref7.content,
          align = _ref7.align,
          style = _ref7.style;
      return /*#__PURE__*/React.createElement("div", {
        className: mergeClasses('cell', 'head', withClass(null, cellIndex, align)),
        key: cellIndex,
        "aria-label": "Header label",
        style: withStyle(cellIndex, style)
      }, content);
    })), /*#__PURE__*/React.createElement("div", {
      className: "body",
      style: loading ? getRowStyles(0, colors) : null
    }, hasRows && map$3(body, function (cells, rowIndex) {
      return /*#__PURE__*/React.createElement("div", {
        className: "row",
        key: rowIndex,
        style: getRowStyles(rowIndex, colors)
      }, map$3(cells, function (_ref8, cellIndex) {
        var content = _ref8.content,
            align = _ref8.align,
            style = _ref8.style,
            params = _ref8.params;
        return /*#__PURE__*/React.createElement("div", {
          className: mergeClasses('cell', withClass(rowIndex, cellIndex, align, params)),
          key: cellIndex,
          "aria-label": "",
          style: withStyle(cellIndex, style)
        }, withContent(rowIndex, content, params));
      }));
    }), loading && /*#__PURE__*/React.createElement(Spinner, null)));
  };

  function useDynamicCells() {
    var _useState = useState$3({}),
        _useState2 = _slicedToArray(_useState, 2),
        dynamicCells = _useState2[0],
        setDynamicCells = _useState2[1];

    var updateCells = useCallback$3(function (value, ref, kind) {
      setDynamicCells(function (prev) {
        return _objectSpread2(_objectSpread2({}, prev), {}, _defineProperty({}, ref, _objectSpread2(_objectSpread2({}, get$2(prev, ref, {})), {}, _defineProperty({}, kind, value))));
      });
    }, []);
    return [dynamicCells, updateCells];
  }
  ZukitTable.useDynamicCells = useDynamicCells;

  var _excluded$3 = ["condition", "wrap", "children"];
  // WordPress dependencies
  var _lodash$9 = lodash,
      isString = _lodash$9.isString,
      trim = _lodash$9.trim;
  var createElement$1 = wp.element.createElement; // Conditional Wrap Component
  // condition ? wrap(children) : children

  var ConditionalWrap = function ConditionalWrap(_ref) {
    var condition = _ref.condition,
        WrappingComponent = _ref.wrap,
        children = _ref.children,
        additionalProps = _objectWithoutProperties(_ref, _excluded$3);

    if (condition) {
      if (isString(WrappingComponent)) {
        // built-in components can be wrapped in angular brackets
        var elementType = trim(WrappingComponent, '</>');
        return createElement$1(elementType, additionalProps, children);
      }

      return /*#__PURE__*/React.createElement(WrappingComponent, additionalProps, children);
    }

    return children;
  };

  var _excluded$2 = ["className", "columns", "isSecondary", "isSmall", "withoutControl", "fillMissing", "fillNull", "recap", "options", "selectedItem", "transformValue", "beforeItem", "afterItem", "label", "help", "buttonStyle", "buttonClass", "withLabels", "withTooltip", "onClick"],
      _excluded2 = ["label", "value", "style", "isDisabled", "isSlot"];
  // WordPress dependencies
  var _lodash$8 = lodash,
      map$2 = _lodash$8.map,
      defaults$1 = _lodash$8.defaults,
      upperFirst = _lodash$8.upperFirst,
      isFunction$1 = _lodash$8.isFunction,
      isPlainObject = _lodash$8.isPlainObject,
      has$1 = _lodash$8.has,
      every = _lodash$8.every,
      pick = _lodash$8.pick,
      omit = _lodash$8.omit;
  var _wp$components$4 = wp.components,
      BaseControl$2 = _wp$components$4.BaseControl,
      Tooltip$2 = _wp$components$4.Tooltip,
      Button$3 = _wp$components$4.Button,
      ButtonGroup = _wp$components$4.ButtonGroup; // Internal dependencies

  var cname = 'zukit-select-item';
  var buttonPossibleProps = ['href', 'target', 'disabled', 'icon', 'iconSize', 'shortcut', 'onMouseDown', 'isPrimary', 'isTertiary', 'isPressed', 'isBusy', 'isDefault', 'isLink', 'isDestructive'];

  var SelectItemControl = function SelectItemControl(_ref) {
    var className = _ref.className,
        _ref$columns = _ref.columns,
        columns = _ref$columns === void 0 ? 2 : _ref$columns,
        _ref$isSecondary = _ref.isSecondary,
        isSecondary = _ref$isSecondary === void 0 ? true : _ref$isSecondary,
        _ref$isSmall = _ref.isSmall,
        isSmall = _ref$isSmall === void 0 ? true : _ref$isSmall,
        withoutControl = _ref.withoutControl,
        fillMissing = _ref.fillMissing,
        fillNull = _ref.fillNull,
        recap = _ref.recap,
        options = _ref.options,
        selectedItem = _ref.selectedItem,
        transformValue = _ref.transformValue,
        beforeItem = _ref.beforeItem,
        afterItem = _ref.afterItem,
        label = _ref.label,
        help = _ref.help,
        buttonStyle = _ref.buttonStyle,
        buttonClass = _ref.buttonClass,
        withLabels = _ref.withLabels,
        withTooltip = _ref.withTooltip,
        _onClick = _ref.onClick,
        additionalProps = _objectWithoutProperties(_ref, _excluded$2);

    // fill 'missing' items with 'empty' slots if requested
    var missingCount = fillMissing ? Math.ceil(options.length / columns) * columns - options.length : 0;
    var missing = Array(missingCount).fill().map(function (_, i) {
      return {
        value: "slot".concat(i),
        isDisabled: true,
        isSlot: true
      };
    }); // select the style depending on the button state (taken into account 'isDisabled' and 'isSelected')

    var smartStyle = function smartStyle(style, isDisabled, value, selectedItem) {
      if (isDisabled && has$1(style, 'isDisabled')) return style['isDisabled'];
      if (selectedItem === value && !isDisabled && has$1(style, 'isSelected')) return style['isSelected'];
      return omit(style, ['isSelected', 'isDisabled']);
    };

    var makeItem = function makeItem(_ref2) {
      var label = _ref2.label,
          value = _ref2.value,
          style = _ref2.style,
          isDisabled = _ref2.isDisabled,
          isSlot = _ref2.isSlot,
          more = _objectWithoutProperties(_ref2, _excluded2);

      return /*#__PURE__*/React.createElement(ConditionalWrap, {
        condition: withTooltip,
        wrap: Tooltip$2,
        text: label,
        key: getKey(value, label)
      }, /*#__PURE__*/React.createElement("div", {
        key: getKey(value, label),
        className: mergeClasses("".concat(cname, "__button-wrapper"), "".concat(cname, "__").concat(value), {
          'is-selected': selectedItem === value && !isDisabled,
          'is-disabled': isDisabled,
          'is-slot': isSlot,
          'is-null': fillNull && value === null
        })
      }, /*#__PURE__*/React.createElement(Button$3, _extends({
        className: mergeClasses("".concat(cname, "__button"), buttonClass, "".concat(cname, "__").concat(value), {
          'is-selected': selectedItem === value && !isDisabled // 'is-clickable': fillNull && value === null,

        }),
        isSecondary: isSecondary,
        isSmall: isSmall,
        onClick: function onClick() {
          return isDisabled ? false : _onClick(value);
        },
        style: style || smartStyle(buttonStyle, isDisabled, value, selectedItem)
      }, pick(additionalProps, buttonPossibleProps)), fillNull && value === null ? /*#__PURE__*/React.createElement("span", {
        className: "is-null"
      }) : isSlot ? null : isFunction$1(transformValue) ? transformValue(value, label, style, more) : value), !isSlot && withLabels && /*#__PURE__*/React.createElement("div", {
        className: "block-editor-block-styles__item-label"
      }, label)));
    };

    var defaultRecapOptions = {
      label: upperFirst(selectedItem),
      value: selectedItem,
      style: null,
      isDisabled: true
    };
    var recapOptions = isPlainObject(recap) ? defaults$1(recap, defaultRecapOptions) : defaultRecapOptions;
    var selectOptions = every(options, function (o) {
      return isPlainObject(o);
    }) ? options : map$2(options, function (o) {
      return {
        label: upperFirst(o),
        value: o
      };
    });
    var baseClassName = mergeClasses(className, 'components-base-control', cname, "__".concat(columns, "columns"), {
      '__recap': recap
    });
    return /*#__PURE__*/React.createElement(ConditionalWrap, {
      condition: !withoutControl,
      wrap: BaseControl$2,
      className: baseClassName,
      label: label,
      help: help
    }, /*#__PURE__*/React.createElement(ConditionalWrap, {
      condition: withoutControl,
      wrap: "<div>",
      className: baseClassName
    }, /*#__PURE__*/React.createElement(ButtonGroup, {
      "aria-label": label
    }, beforeItem, recap && makeItem(recapOptions), map$2(selectOptions, makeItem), map$2(missing, makeItem), afterItem)));
  };

  var _excluded$1 = ["className", "isColor", "title", "value", "colored"];
  // WordPress dependencies
  var ColorIndicator = wp.components.ColorIndicator; // Internal dependencies

  var panelIndicatorPrefix = 'zukit-title-indicator';

  var TitleIndicator = function TitleIndicator(_ref) {
    var className = _ref.className,
        isColor = _ref.isColor,
        title = _ref.title,
        value = _ref.value,
        colored = _ref.colored,
        props = _objectWithoutProperties(_ref, _excluded$1);

    return /*#__PURE__*/React.createElement("span", {
      className: className
    }, title, value && (isColor ? /*#__PURE__*/React.createElement(ColorIndicator, _extends({
      className: panelIndicatorPrefix,
      colorValue: value
    }, props)) : /*#__PURE__*/React.createElement("span", _extends({
      className: mergeClasses(panelIndicatorPrefix, _defineProperty({}, colored, colored))
    }, props), value)));
  };

  // WordPress dependencies
  var _lodash$7 = lodash,
      isArray = _lodash$7.isArray,
      isEmpty$2 = _lodash$7.isEmpty,
      isNil$3 = _lodash$7.isNil,
      map$1 = _lodash$7.map,
      pull = _lodash$7.pull,
      split = _lodash$7.split,
      join = _lodash$7.join,
      includes$1 = _lodash$7.includes,
      has = _lodash$7.has;
  var __$4 = wp.i18n.__;
  var ENTER$1 = wp.keycodes.ENTER;
  var _wp$compose = wp.compose,
      compose = _wp$compose.compose,
      useInstanceId$1 = _wp$compose.useInstanceId;
  var _wp$components$3 = wp.components,
      BaseControl$1 = _wp$components$3.BaseControl,
      Button$2 = _wp$components$3.Button,
      TextControl$1 = _wp$components$3.TextControl,
      Tooltip$1 = _wp$components$3.Tooltip;
  var _wp$element$4 = wp.element,
      useState$2 = _wp$element$4.useState,
      useCallback$2 = _wp$element$4.useCallback,
      useMemo = _wp$element$4.useMemo;
  var _wp$url = wp.url,
      isEmail = _wp$url.isEmail,
      isURL = _wp$url.isURL; // Internal dependencies

  var cprefix$1 = 'zukit-list-input';
  var closeIcon = 'no-alt';

  var isKind$1 = function isKind(kind, value) {
    // https://stackoverflow.com/questions/4338267/validate-phone-number-with-javascript
    var phoneRegex = /^[+]?[(]?[0-9]{3}[)]?[-\s.]?[0-9]{3}[-\s.]?[0-9]{4,6}$/g;
    if (isNil$3(kind)) return true;
    if (kind === 'email') return isEmail(value);
    if (kind === 'url') return isURL(value);
    if (kind === 'tel' || kind === 'phone') return phoneRegex.test(value); // otherwise any string that we use as a Regular Expression

    var re = new RegExp(kind);
    return re.test(value);
  };

  var messages = {
    duplicate: __$4('Duplicates are not allowed', 'zukit'),
    email: __$4('It does not look like a valid email.', 'zukit'),
    url: __$4('It does not look like a URL.', 'zukit'),
    tel: __$4('It does not look like a phone number.', 'zukit'),
    regex: __$4('It does not look like a valid input.', 'zukit')
  };

  var messageByKind = function messageByKind(kind, value) {
    if (kind === 'phone') kind = 'tel';
    var msg = has(messages, kind) ? messages[kind] : messages.regex;
    return messageWithError(msg, value);
  };

  var ListInputControl = function ListInputControl(_ref) {
    var _ref$separator = _ref.separator,
        separator = _ref$separator === void 0 ? ',' : _ref$separator,
        label = _ref.label,
        help = _ref.help,
        inputLabel = _ref.inputLabel,
        inputHelp = _ref.inputHelp,
        isSideBySide = _ref.isSideBySide,
        strict = _ref.strict,
        value = _ref.value,
        onChange = _ref.onChange,
        isOpen = _ref.isOpen,
        isNotEmptyLabel = _ref.isNotEmptyLabel,
        noticeOperations = _ref.noticeOperations;
    var createNotice = noticeOperations.createNotice;

    var _useState = useState$2(''),
        _useState2 = _slicedToArray(_useState, 2),
        currentItem = _useState2[0],
        setCurrentItem = _useState2[1];

    var _useState3 = useState$2(isOpen),
        _useState4 = _slicedToArray(_useState3, 2),
        editMode = _useState4[0],
        setEditMode = _useState4[1];

    var instanceId = useInstanceId$1(ListInputControl);
    var controlId = "list-input-control-".concat(instanceId); // convert string value to array if needed

    var items = useMemo(function () {
      return isArray(value) ? value : isEmpty$2(value) ? [] : split(value, separator);
    }, [value, separator]); // remove an item by its value

    var onRemoveItem = useCallback$2(function (value) {
      var wasCount = items.length;
      pull(items, value);

      if (items.length < wasCount) {
        onChange(join(items, separator));
      }
    }, [items, onChange, separator]); // clean the list

    var onReset = useCallback$2(function () {
      onChange('');
    }, [onChange]); // add an item to the list (only unique values are allowed)

    var onAddItem = useCallback$2(function () {
      var error = null;

      if (!includes$1(items, currentItem)) {
        if (isKind$1(strict, currentItem)) {
          items.push(currentItem);
          onChange(join(items, separator));
          setCurrentItem('');
        } else {
          error = messageByKind(strict, currentItem);
        }
      } else {
        error = messageWithError(messages.duplicate, currentItem);
      }

      if (error !== null) {
        // Can be one of: success, info, warning, error
        createNotice({
          status: 'warning',
          content: error,
          isDismissible: true,
          __unstableHTML: true
        });
        scrollTop();
      }
    }, [currentItem, items, onChange, separator, strict, createNotice]); // add an item on ENTER key pressed

    var onKeyDown = useCallback$2(function (event) {
      var keyCode = event.keyCode;

      if (keyCode === ENTER$1) {
        onAddItem();
      }
    }, [onAddItem]);
    var isСombined = (isNotEmptyLabel ? !isEmpty$2(items) : true) && (label || help);
    var isInputСombined = isSideBySide && (inputLabel || inputHelp);
    return /*#__PURE__*/React.createElement(BaseControl$1, {
      className: mergeClasses(cprefix$1, {
        __fullwidth: isСombined || isInputСombined
      })
    }, isСombined && /*#__PURE__*/React.createElement("div", {
      className: "__sidebyside __list"
    }, label && /*#__PURE__*/React.createElement("label", {
      className: "components-base-control__label",
      htmlFor: controlId
    }, label), help && /*#__PURE__*/React.createElement("p", {
      className: "components-base-control__help"
    }, help)), /*#__PURE__*/React.createElement("div", {
      className: "__list"
    }, map$1(items, function (val) {
      return /*#__PURE__*/React.createElement("div", {
        className: "__list-item",
        key: getKey(val)
      }, /*#__PURE__*/React.createElement("span", null, val), /*#__PURE__*/React.createElement(Tooltip$1, {
        text: __$4('Remove', 'zukit'),
        position: "top center"
      }, /*#__PURE__*/React.createElement(Button$2, {
        className: "__remove",
        isSecondary: true,
        icon: closeIcon,
        onClick: function onClick() {
          return onRemoveItem(val);
        }
      })));
    }), !editMode && /*#__PURE__*/React.createElement(Button$2, {
      className: "__edit __plugin_actions __auto admin-blue",
      icon: "admin-settings",
      isSecondary: true,
      onClick: function onClick() {
        return setEditMode(true);
      }
    }, __$4('Modify', 'zukit'))), editMode && /*#__PURE__*/React.createElement(React.Fragment, null, isInputСombined && /*#__PURE__*/React.createElement("div", {
      className: "__sidebyside"
    }, inputLabel && /*#__PURE__*/React.createElement("label", {
      className: "components-base-control__label",
      htmlFor: controlId
    }, inputLabel), inputHelp && /*#__PURE__*/React.createElement("p", {
      className: "components-base-control__help"
    }, inputHelp)), /*#__PURE__*/React.createElement("div", {
      className: mergeClasses('__input', // 'is-from-top',
      {
        'components-animate__appear is-from-top': !isOpen,
        '__with-help': inputHelp && !isInputСombined,
        '__with-label-help': isInputСombined
      })
    }, /*#__PURE__*/React.createElement(TextControl$1, _extends({
      label: isInputСombined ? undefined : inputLabel || __$4('Enter new item', 'zukit'),
      help: isInputСombined ? undefined : inputHelp,
      value: currentItem,
      onChange: setCurrentItem,
      onKeyDown: onKeyDown
    }, isInputСombined ? {
      id: controlId
    } : {})), /*#__PURE__*/React.createElement(Button$2, {
      className: "__add __plugin_actions admin-blue",
      icon: "tag",
      isSecondary: true,
      onClick: onAddItem
    }, __$4('Add', 'zukit')), /*#__PURE__*/React.createElement(Button$2, {
      className: "__reset __plugin_actions magenta",
      isSecondary: true,
      icon: "trash",
      onClick: onReset
    }, __$4('Reset All', 'zukit')))));
  };

  var listInputControl = compose([withNoticesContext])(ListInputControl);

  // WordPress dependencies
  var _lodash$6 = lodash,
      isNil$2 = _lodash$6.isNil,
      isEmpty$1 = _lodash$6.isEmpty,
      isFunction = _lodash$6.isFunction,
      debounce = _lodash$6.debounce;
  var __$3 = wp.i18n.__;
  var ENTER = wp.keycodes.ENTER;
  var _wp$components$2 = wp.components,
      Button$1 = _wp$components$2.Button,
      TextControl = _wp$components$2.TextControl,
      Tooltip = _wp$components$2.Tooltip;
  var _wp$element$3 = wp.element,
      useCallback$1 = _wp$element$3.useCallback,
      useState$1 = _wp$element$3.useState,
      useEffect$2 = _wp$element$3.useEffect;
  var useInstanceId = wp.compose.useInstanceId; // Internal dependencies

  var labels = {
    show: __$3('Show Password', 'zukit'),
    hide: __$3('Hide Password', 'zukit'),
    clear: __$3('Clear', 'zukit')
  };

  var isKind = function isKind(kind, value) {
    if (value === '' || isNil$2(kind)) return true;
    if (kind === 'number') return /^[0-9]+$/g.test(value);
    if (kind === 'email') return /^[a-zA-Z0-9._@-]+$/g.test(value);
    if (kind === 'url') return /^[.a-zA-Z0-9-]+$/g.test(value);
    if (kind === 'tel' || kind === 'phone') return /^[0-9()+-\s]+$/g.test(value); // otherwise any string that we use as a Regular Expression

    var re = new RegExp(kind);
    return re.test(value);
  };

  var setValidatedValue = function setValidatedValue(val, withoutValues, fallbackValue, kind) {
    var emptyIfFailed = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;
    var value = isEmpty$1(withoutValues) ? val : uniqueValue(val, withoutValues, fallbackValue);
    return isKind(kind, value) ? value : emptyIfFailed ? '' : null;
  };

  var AdvTextControl = function AdvTextControl(_ref) {
    var className = _ref.className,
        isPassword = _ref.isPassword,
        isSideBySide = _ref.isSideBySide,
        _ref$showTooltip = _ref.showTooltip,
        showTooltip = _ref$showTooltip === void 0 ? true : _ref$showTooltip,
        _ref$tooltipPosition = _ref.tooltipPosition,
        tooltipPosition = _ref$tooltipPosition === void 0 ? 'top center' : _ref$tooltipPosition,
        withoutClear = _ref.withoutClear,
        id = _ref.id,
        label = _ref.label,
        value = _ref.value,
        help = _ref.help,
        type = _ref.type,
        strict = _ref.strict,
        withDebounce = _ref.withDebounce,
        _ref$debounceDelay = _ref.debounceDelay,
        debounceDelay = _ref$debounceDelay === void 0 ? 1000 : _ref$debounceDelay,
        _ref$withoutValues = _ref.withoutValues,
        withoutValues = _ref$withoutValues === void 0 ? null : _ref$withoutValues,
        _ref$fallbackValue = _ref.fallbackValue,
        fallbackValue = _ref$fallbackValue === void 0 ? 'name' : _ref$fallbackValue,
        onChange = _ref.onChange,
        onKeyEnter = _ref.onKeyEnter;

    var _useState = useState$1(false),
        _useState2 = _slicedToArray(_useState, 2),
        visible = _useState2[0],
        setVisible = _useState2[1];

    var _useState3 = useState$1(false),
        _useState4 = _slicedToArray(_useState3, 2),
        debounceActive = _useState4[0],
        setDebounceActive = _useState4[1];

    var controlType = isPassword ? visible ? 'text' : 'password' : type || 'text';
    var controlIcon = isPassword ? visible ? 'hidden' : 'visibility' : 'no-alt';
    var controlTooltip = isPassword ? visible ? labels.hide : labels.show : labels.clear;
    var instanceId = useInstanceId(AdvTextControl);
    var controlId = id !== null && id !== void 0 ? id : "advanced-text-control-".concat(instanceId);
    var onClear = useCallback$1(function () {
      setTemporaryValue('');
      onChange('');
    }, [onChange]);
    var onClick = useCallback$1(function () {
      return isPassword ? setVisible(!visible) : onClear();
    }, [isPassword, visible, onClear]); // Debounce ---------------------------------------------------------------]
    // using temporaryName while debouncing name changes

    var _useState5 = useState$1(setValidatedValue(value, withoutValues, fallbackValue, strict, true)),
        _useState6 = _slicedToArray(_useState5, 2),
        temporaryValue = _useState6[0],
        setTemporaryValue = _useState6[1]; // using debouncing to reduce the number of calls to the onChange handler
    // eslint-disable-next-line react-hooks/exhaustive-deps


    var onUpdateValue = useCallback$1(debounce(function (value) {
      onChange(value);
      setDebounceActive(false);
    }, debounceDelay), [onChange, debounceDelay]);
    var onChangeValue = useCallback$1(function (value) {
      setDebounceActive(true);
      setTemporaryValue(value);
      onUpdateValue(value);
    }, [onUpdateValue]); // call handler on ENTER key pressed

    var onEnter = useCallback$1(function (event) {
      var keyCode = event.keyCode;

      if (keyCode === ENTER && isFunction(onKeyEnter)) {
        onKeyEnter();
      }
    }, [onKeyEnter]); // sync 'temporaryValue' and 'value' what can happen if 'value' was changed outside the component и
    // after the component has been mounted and the 'temporaryValue' state has already been initialized

    useEffect$2(function () {
      if (debounceActive === false) {
        if (temporaryValue !== value) {
          var newValue = setValidatedValue(value, withoutValues, fallbackValue, strict, true);
          if (newValue !== value) onChange(newValue);
          if (newValue !== temporaryValue) setTemporaryValue(newValue);
        }
      }
    }, [debounceActive, value, onChange, temporaryValue, withoutValues, fallbackValue, strict]); // Validate ---------------------------------------------------------------]

    var withButton = isPassword || !withoutClear;
    var onValidatedChange = useCallback$1(function (val) {
      var value = setValidatedValue(val, withoutValues, fallbackValue, strict);

      if (value !== null) {
        if (withDebounce) onChangeValue(value);else onChange(value);
      }
    }, [strict, withDebounce, onChange, onChangeValue, withoutValues, fallbackValue]);
    var isСombined = isSideBySide && (label || help);
    return /*#__PURE__*/React.createElement(React.Fragment, null, isСombined && /*#__PURE__*/React.createElement("div", {
      className: "__sidebyside components-base-control"
    }, label && /*#__PURE__*/React.createElement("label", {
      className: "components-base-control__label",
      htmlFor: controlId
    }, label), help && /*#__PURE__*/React.createElement("p", {
      className: "components-base-control__help"
    }, help)), /*#__PURE__*/React.createElement("div", {
      className: mergeClasses('components-base-control', 'zukit-text-control', className, {
        '__with-label': !isСombined && label && withButton,
        '__with-help': !isСombined && help,
        '__with-label-help': !isСombined && label && help && withButton,
        '__with-button': withButton
      })
    }, /*#__PURE__*/React.createElement(TextControl, _extends({
      type: controlType,
      label: isСombined ? undefined : label,
      help: isСombined ? undefined : help,
      value: (withDebounce ? temporaryValue : value) || '',
      onChange: onValidatedChange,
      onKeyDown: onEnter
    }, isСombined ? {
      id: controlId
    } : {})), withButton && /*#__PURE__*/React.createElement(ConditionalWrap, {
      wrap: Tooltip,
      condition: showTooltip,
      text: controlTooltip,
      position: tooltipPosition,
      noArrow: false
    }, /*#__PURE__*/React.createElement(Button$1, {
      className: mergeClasses('__exclude', {
        '__with-label': !isСombined && label && withButton,
        '__with-label-help': !isСombined && label && help && withButton
      }),
      icon: controlIcon,
      onClick: onClick
    }))));
  };

  // WordPress dependencies
  // https://developer.wordpress.org/block-editor/packages/packages-data/
  var _lodash$5 = lodash,
      keys = _lodash$5.keys,
      get$1 = _lodash$5.get,
      defaults = _lodash$5.defaults;
  var registerStore = wp.data.registerStore;
  var _wp = wp,
      apiFetch = _wp.apiFetch; // Internal dependencies
  var TYPES = {
    GET_VALUE: 'GET_VALUE',
    SET_VALUE: 'SET_VALUE',
    UPDATE_VALUES: 'UPDATE_VALUES'
  }; // An empty object indicates that no value was found for option,
  // or something went wrong during the option update

  var isNull = function isNull(val) {
    return Object.keys(val).length === 0 && val.constructor === Object;
  };

  function getReadOnlyActions() {
    return {
      getValue: function getValue(path) {
        return {
          type: TYPES.GET_VALUE,
          path: path
        };
      },
      setValue: function setValue(key, value) {
        var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
        return _objectSpread2({
          type: TYPES.SET_VALUE,
          key: key,
          value: value
        }, params);
      }
    };
  }

  function getActions(route, router, fetchKey) {
    var readOnly = getReadOnlyActions();
    var updateParams = fetchKey ? {
      key: fetchKey
    } : {};
    return _objectSpread2(_objectSpread2({}, readOnly), {}, {
      updateValues: /*#__PURE__*/regeneratorRuntime.mark(function updateValues(values) {
        var path, data, result;
        return regeneratorRuntime.wrap(function updateValues$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                path = requestURL(route);
                data = _objectSpread2(_objectSpread2({}, updateParams), {}, {
                  router: router,
                  keys: keys(values),
                  values: values
                });
                _context.next = 4;
                return apiFetch({
                  path: path,
                  method: 'POST',
                  data: data
                });

              case 4:
                result = _context.sent;
                return _context.abrupt("return", isNull(result) ? undefined : {
                  type: TYPES.UPDATE_VALUES,
                  values: values
                });

              case 6:
              case "end":
                return _context.stop();
            }
          }
        }, updateValues);
      })
    });
  }
  function defaultGetter(state, stateKey, valueKey) {
    return get$1(state, [stateKey, valueKey]);
  }
  function getSelectors(stateKey, getter) {
    return {
      getValue: function getValue(state, key) {
        var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
        return getter(state, stateKey, key, params);
      }
    };
  }
  function getControls() {
    return {
      GET_VALUE: function GET_VALUE(action) {
        return apiFetch({
          path: action.path
        });
      }
    };
  }
  function getResolvers(route, router, actions, fetchKey) {
    return {
      getValue: /*#__PURE__*/regeneratorRuntime.mark(function getValue(key) {
        var params,
            requestKey,
            path,
            value,
            _args2 = arguments;
        return regeneratorRuntime.wrap(function getValue$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                params = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : {};
                requestKey = {
                  key: fetchKey || key
                };
                path = requestURL(route, _objectSpread2(_objectSpread2({}, requestKey), params), router);
                _context2.next = 5;
                return actions.getValue(path);

              case 5:
                value = _context2.sent;
                return _context2.abrupt("return", actions.setValue(key, isNull(value) ? undefined : value, params));

              case 7:
              case "end":
                return _context2.stop();
            }
          }
        }, getValue);
      })
    };
  }
  function defaultMerger(prevState, stateKey, action) {
    return _objectSpread2(_objectSpread2({}, prevState), {}, _defineProperty({}, stateKey, _objectSpread2(_objectSpread2({}, prevState[stateKey]), {}, _defineProperty({}, action.key, action.value))));
  }

  function getReducer(stateKey, initialState, merger) {
    return function () {
      var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;
      var action = arguments.length > 1 ? arguments[1] : undefined;

      switch (action.type) {
        case TYPES.SET_VALUE:
          return merger(state, stateKey, action);

        case TYPES.UPDATE_VALUES:
          return _objectSpread2(_objectSpread2({}, state), {}, _defineProperty({}, stateKey, _objectSpread2(_objectSpread2({}, state[stateKey]), action.values)));
      }

      return state;
    };
  }

  function setupStore(params) {
    var storeParams = defaults({}, params, {
      name: null,
      stateKey: 'data',
      routes: {
        get: 'cuget',
        update: 'cuset'
      },
      router: null,
      fetchKey: null,
      // used only for custom stores
      withSetters: true,
      withoutResolvers: false,
      initialState: null,
      merger: defaultMerger,
      getter: defaultGetter,
      reducer: null,
      actions: null,
      selectors: null,
      controls: null
    });
    var name = storeParams.name,
        stateKey = storeParams.stateKey,
        routes = storeParams.routes,
        router = storeParams.router,
        fetchKey = storeParams.fetchKey;

    var initialState = storeParams.initialState || _defineProperty({}, stateKey, {});

    var getRoute = get$1(routes, 'get', routes);
    var updateRoute = get$1(routes, 'update', routes);
    var actions = storeParams.withSetters ? getActions(updateRoute, router, fetchKey) : getReadOnlyActions();
    return {
      register: function register() {
        return registerStore(name, {
          reducer: storeParams.reducer || getReducer(stateKey, initialState, storeParams.merger),
          actions: storeParams.actions || actions,
          selectors: storeParams.selectors || getSelectors(stateKey, storeParams.getter),
          controls: storeParams.controls || getControls(),
          resolvers: storeParams.withoutResolvers ? undefined : getResolvers(getRoute, router, actions, fetchKey)
        });
      }
    };
  }

  // WordPress dependencies
  var _lodash$4 = lodash,
      isEmpty = _lodash$4.isEmpty,
      isNil$1 = _lodash$4.isNil,
      get = _lodash$4.get,
      includes = _lodash$4.includes;
      _lodash$4.repeat;
      _lodash$4.forEach;
      _lodash$4.sortBy;
  var __$2 = wp.i18n.__;
  var createHigherOrderComponent = wp.compose.createHigherOrderComponent;
  var _wp$data$1 = wp.data,
      withSelect = _wp$data$1.withSelect,
      useSelect = _wp$data$1.useSelect; // Internal dependencies

  var ZUKIT_STORE = 'zukit/core';

  var basicKeys = ['loaders', 'galleries', 'folders'];

  function dataMerger(prevState, stateKey, action) {
    var key = action.key,
        value = action.value;
    var prevDataState = get(prevState, stateKey, {});
    var prevKeyState = get(prevDataState, key, {});

    if (includes(basicKeys, key)) {
      return defaultMerger(prevState, stateKey, action);
    } else if (key === 'svg') {
      var name = action.name,
          folder = action.folder;
      var prevFolderState = get(prevKeyState, folder, {});
      return _objectSpread2(_objectSpread2({}, prevState), {}, _defineProperty({}, stateKey, _objectSpread2(_objectSpread2({}, prevDataState), {}, {
        svg: _objectSpread2(_objectSpread2({}, prevKeyState), {}, _defineProperty({}, folder, _objectSpread2(_objectSpread2({}, prevFolderState), {}, _defineProperty({}, name, value))))
      })));
    }

    return prevState;
  }

  function dataGetter(state, stateKey, key, params) {
    if (includes(basicKeys, key)) {
      return defaultGetter(state, stateKey, key);
    } else if (key === 'svg') {
      var name = params.name,
          folder = params.folder;
      return get(state, [stateKey, key, folder, name]);
    }

    return undefined;
  }

  var _setupStore = setupStore({
    name: ZUKIT_STORE,
    stateKey: 'data',
    routes: 'zudata',
    withSetters: false,
    initialState: {
      data: {
        folders: {},
        loaders: {},
        galleries: {},
        svg: {}
      }
    },
    merger: dataMerger,
    getter: dataGetter
  }),
      registerCoreStore = _setupStore.register;

  registerCoreStore(); // Custom hooks ---------------------------------------------------------------]
  // Higher-order component which add 'folders' to the original component

  createHigherOrderComponent(withSelect(function (select) {
    return {
      folders: select(ZUKIT_STORE).getValue('folders') || null
    };
  }), 'withFolders');

  [{
    value: 0,
    label: __$2('Loading...', 'zukit')
  }];
  ({
    value: 0,
    label: __$2('Select folder', 'zukit')
  });
  // Higher-order component which add 'loaderHTML' to the original component

  createHigherOrderComponent(withSelect(function (select, _ref) {
    var loader = _ref.loader;
    var loaderIndex = isNum(loader) ? loader : null;
    var loaderRaw = null;

    if (!isNil$1(loaderIndex)) {
      loaderRaw = select(ZUKIT_STORE).getValue('loaders', {
        loaderIndex: loaderIndex
      }) || null;
    }

    return {
      loaderHTML: isEmpty(loaderRaw) ? null : loaderRaw
    };
  }), 'withLoaders'); // Custom hook which returns 'loader' by 'index' (all loaders if index is 'null')

  var useLoaders = function useLoaders() {
    var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;

    var _useSelect5 = useSelect(function (select) {
      return {
        loaders: select(ZUKIT_STORE).getValue('loaders')
      };
    }, []),
        _useSelect5$loaders = _useSelect5.loaders,
        loaders = _useSelect5$loaders === void 0 ? null : _useSelect5$loaders;

    return isEmpty(loaders) ? null : index === null ? loaders : get(loaders, index, null);
  };

  // WordPress dependencies
  var _lodash$3 = lodash;
      _lodash$3.isNil;
      _lodash$3.isArray;
      _lodash$3.isEmpty;
      _lodash$3.isFunction;
      _lodash$3.isPlainObject;
      _lodash$3.some;
      _lodash$3.reduce;
      _lodash$3.defaults;
  var _wp$data = wp.data;
      _wp$data.useSelect;
      _wp$data.useDispatch;
  var _wp$element$2 = wp.element;
      _wp$element$2.useRef;
      _wp$element$2.useReducer; // Internal dependencies

  // WordPress dependencies
  var _lodash$2 = lodash,
      isNil = _lodash$2.isNil;
  var RawHTML$1 = wp.element.RawHTML; // Internal dependencies

  var Loader = function Loader(_ref) {
    var className = _ref.className,
        loaderHTML = _ref.loaderHTML;
    return isNil(loaderHTML) ? null : /*#__PURE__*/React.createElement(RawHTML$1, {
      className: mergeClasses('zu-loader', className)
    }, loaderHTML);
  };

  var WithOptions = function WithOptions(_ref2) {
    var className = _ref2.className,
        _ref2$id = _ref2.id,
        id = _ref2$id === void 0 ? 'none' : _ref2$id,
        duration = _ref2.duration;
    var loaderHTML = useLoaders(id, duration);
    return /*#__PURE__*/React.createElement(Loader, {
      className: className,
      loaderHTML: loaderHTML
    });
  };

  Loader.WithOptions = WithOptions;

  // WordPress dependencies
  var _lodash$1 = lodash,
      reduce = _lodash$1.reduce;
  var __$1 = wp.i18n.__;
  var _wp$element$1 = wp.element,
      useState = _wp$element$1.useState,
      useCallback = _wp$element$1.useCallback,
      useEffect$1 = _wp$element$1.useEffect;
  var _wp$components$1 = wp.components,
      BaseControl = _wp$components$1.BaseControl,
      ToggleControl = _wp$components$1.ToggleControl; // Internal dependencies

  var cprefix = 'zukit-loader-control';

  var LoaderControl = function LoaderControl(_ref) {
    var clientId = _ref.clientId,
        className = _ref.className,
        _ref$editClassName = _ref.editClassName,
        editClassName = _ref$editClassName === void 0 ? '__edit-mode' : _ref$editClassName,
        label = _ref.label,
        _ref$shape = _ref.shape,
        shape = _ref$shape === void 0 ? 'none' : _ref$shape,
        loaders = _ref.loaders,
        setAttributes = _ref.setAttributes;

    var _useState = useState(false),
        _useState2 = _slicedToArray(_useState, 2),
        revealLoader = _useState2[0],
        setRevealLoader = _useState2[1];

    var onReveal = useCallback(function () {
      setRevealLoader(!revealLoader);
    }, [revealLoader]);
    var onChange = useCallback(function (loader) {
      if (loaders === null) return;
      setAttributes({
        loader: loader,
        loaderHTML: loaders[loader] || ''
      });
    }, [loaders, setAttributes]); // Clear all DOM modifications on unmount

    useEffect$1(function () {
      return function () {
        alterClassWithClientId(clientId, '> :first-child', editClassName); // cssWithClientId(clientId, 'opacity', undefined, `.${editClassName}`); // '.zu-gallery__edit'

        cssWithClientId(clientId, 'opacity', undefined, '.zu-loader');
      }; // eslint-disable-next-line react-hooks/exhaustive-deps
    }, []);
    useEffect$1(function () {
      alterClassWithClientId(clientId, '> :first-child', revealLoader ? null : editClassName, revealLoader ? editClassName : null); // cssWithClientId(clientId, 'opacity', revealLoader ? 0.2 : undefined, `.${editClassName}`); // '.zu-gallery__edit'

      cssWithClientId(clientId, 'opacity', revealLoader ? 1 : undefined, '.zu-loader');
    }, [clientId, revealLoader, shape, editClassName]);
    if (loaders === null) return null;
    var loaderOptions = reduce(loaders, function (options, _val, key) {
      options.push({
        value: String(key),
        label: String(key)
      });
      return options;
    }, [{
      value: 'none',
      label: __$1('Without Loader', 'zukit')
    }]);
    /* translators: loader selection */

    var noLoader = /*#__PURE__*/React.createElement("span", null, __$1('none', 'zukit'));
    return /*#__PURE__*/React.createElement(BaseControl, {
      className: mergeClasses(cprefix, className),
      label: label
    }, /*#__PURE__*/React.createElement(SelectItemControl, {
      withoutControl: true,
      columns: 3,
      options: loaderOptions,
      selectedItem: String(shape),
      onClick: onChange,
      transformValue: function transformValue(value) {
        return value === 'none' ? noLoader : /*#__PURE__*/React.createElement(Loader, {
          loaderHTML: loaders[parseInt(value, 10)]
        });
      }
    }), /*#__PURE__*/React.createElement(ToggleControl, {
      label: __$1('Reveal Loader', 'zukit'),
      checked: revealLoader,
      onChange: onReveal
    }));
  };

  // WordPress dependencies
  var _lodash = lodash,
      map = _lodash.map,
      castArray = _lodash.castArray;
  var __ = wp.i18n.__;
  var Fragment = wp.element.Fragment;
  var _wp$components = wp.components,
      Button = _wp$components.Button,
      Icon = _wp$components.Icon,
      Modal = _wp$components.Modal; // Internal dependencies

  var ModalMessage = function ModalMessage(_ref) {
    var className = _ref.className,
        icon = _ref.icon,
        message = _ref.message,
        links = _ref.links,
        withoutCloseButton = _ref.withoutCloseButton,
        isOpen = _ref.isOpen,
        onClose = _ref.onClose,
        children = _ref.children;
    var modalIcon = icon === 'warning' ? warning : icon === 'error' ? error$1 : info;
    return isOpen && /*#__PURE__*/React.createElement(Modal, {
      className: mergeClasses('zukit-modal', className),
      title: __('Warning', 'zu-contact'),
      closeLabel: __('Close'),
      onRequestClose: onClose
    }, /*#__PURE__*/React.createElement("div", {
      className: "__content-wrapper"
    }, /*#__PURE__*/React.createElement(Icon, {
      className: "__icon",
      icon: modalIcon
    }), /*#__PURE__*/React.createElement("div", null, simpleMarkdown(message, {
      links: links
    }))), /*#__PURE__*/React.createElement("div", {
      className: "__button-wrapper"
    }, map(castArray(children || []), function (button, key) {
      return /*#__PURE__*/React.createElement(Fragment, {
        key: key
      }, button);
    }), !withoutCloseButton && /*#__PURE__*/React.createElement(Button, {
      isPrimary: true,
      onClick: onClose
    }, __('Close'))));
  };

  var _excluded = ["tag", "children"];
  // WordPress dependencies
  var createElement = wp.element.createElement; // Alternative RawHTML Component

  var RawHTML = function RawHTML(_ref) {
    var _ref$tag = _ref.tag,
        tag = _ref$tag === void 0 ? 'p' : _ref$tag,
        children = _ref.children,
        props = _objectWithoutProperties(_ref, _excluded);

    return createElement(tag, _objectSpread2({
      dangerouslySetInnerHTML: {
        __html: children
      }
    }, props));
  };

  // Components

  var components = /*#__PURE__*/Object.freeze({
    __proto__: null,
    ZukitSkeleton: ZukitSkeleton$1,
    ZukitSidebar: ZukitSidebar,
    ZukitPanel: ZukitPanel,
    ZukitDivider: ZukitDivider,
    ZukitTable: ZukitTable,
    ConditionalWrap: ConditionalWrap,
    SelectItemControl: SelectItemControl,
    TitleIndicator: TitleIndicator,
    ListInputControl: listInputControl,
    AdvTextControl: AdvTextControl,
    Loader: Loader,
    LoaderControl: LoaderControl,
    ModalMessage: ModalMessage,
    RawHTML: RawHTML
  });

  var name = "zumedia";
  var version = "2.2.3";
  var testedWP = "5.7.1";
  var requiresPHP = ">=7.2.0";
  var author = "Dmitry Rudakov";
  var description = "Enhances WordPress Media Library with some features (folders, dominant color, location category and others).";
  var license = "GPL-2.0-or-later";
  var repository = {
  	type: "git",
  	url: "https://github.com/picasso/zumedia.git"
  };
  var keywords = [
  	"wordpress",
  	"media",
  	"plugin",
  	"gutenberg",
  	"responsive"
  ];
  var scripts = {
  };
  var devDependencies = {
  	"@types/marked": "^4.0.1",
  	"@wordpress/eslint-plugin": "^9.3.0",
  	eslint: "^8.2.0",
  	"eslint-plugin-react": "^7.26.1",
  	"eslint-plugin-react-hooks": "^4.2.0",
  	marked: "^4.0.4",
  	prettier: "^2.4.1",
  	"replace-in-file": "^6.3.2",
  	typescript: "^4.5.2"
  };
  var dependencies = {
  	classnames: "^2.3.1",
  	"jquery-hoverintent": "^1.10.1",
  	waypoints: "^4.0.1"
  };
  var zuPackage = {
  	name: name,
  	version: version,
  	testedWP: testedWP,
  	requiresPHP: requiresPHP,
  	author: author,
  	description: description,
  	license: license,
  	repository: repository,
  	keywords: keywords,
  	scripts: scripts,
  	devDependencies: devDependencies,
  	dependencies: dependencies
  };

  // WordPress dependencies
  var _ = lodash;
  var _wp$element = wp.element,
      useEffect = _wp$element.useEffect,
      useRef = _wp$element.useRef;
  var usePrevious = wp.compose.usePrevious;
  //
  //      'short' || 1                - only milestone messages & warn (without data and annoying handlers)
  //      'default' || 'normal' || 2  - all messages & warn (but without data)
  //      'verbose' || 'full' || 3    - all messages & their data
  //      'none' || 0                 - only errors
  // Examples of using:
  //
  //      * * * all data will be cloned before output to avoid reacting to subsequent changes * * *
  //
  //      Zubug.useTrace(props, state)    - trace the changes of the props ('state' arg is optional)
  //      Zubug.data({images, action})    - output data {name: value}
  //      Zubug.useTraceWithId(props);    - trace the changes of the props when there is 'clientId' among the props
  //      Zubug.data({images, action})    - output data (name: value)
  //      Zubug.info('text', {id, links}) - output data with text label
  //      Zubug.akaMount()                - output information when a component has been mounted or unmounted
  //      Zubug.renderWithId(clientId)    - output information when the component was rendered
  //      Zubug.log(message, ...data)     - output message with data
  //
  // Ajax helpers:
  //      Zubug.request(route, options)   - output Ajax request information
  //      Zubug.response(route, data)     - output Ajax response information
  // Модификаторы цвета и шрифта (первый символ сообщения для log() и info()):
  //      '!' - console.info, bold, '#cc0096'
  //      '?' - bold, '#ff2020'
  //      '>' - начать группу
  //      '#' - bold, '#ffffff' на фоне '#e50039' в окружении ★★★
  // some internal vars

  var config = {
    version: zuPackage.version ,
    level: 'default',
    simplify: true,
    // когда установлено, то пытается упростить вывод
    //  - например, заменяет вывод массива с одним элементом на
    //  на вывод element[0] как объекта и т.д.
    mods: {
      ignoreNext: false,
      // do not output next error
      consoleDir: false,
      // use console.dir to output values
      forseNil: false // forse output even value is null or undefined

    },
    colors: {
      same: false,
      trace: false,
      info: false,
      data: false,
      render: false,
      mount: false
    },
    markers: {
      accented: '±',
      bold: '§',
      colored: '~',
      param: ['[', ']'],
      opaque: ['{', '}']
    },
    timing: false
  };

  var _markers = _.transform(config.markers, function (a, v, k) {
    return a[k[0]] = v;
  });

  var _accented = function _accented(s) {
    return "".concat(_markers.a).concat(s).concat(_markers.a);
  };

  var _bold = function _bold(s) {
    return "".concat(_markers.b).concat(s).concat(_markers.b);
  };

  var _colored = function _colored(s) {
    return "".concat(_markers.c).concat(s).concat(_markers.c);
  };

  var _param = function _param(s, alt) {
    return "".concat(_markers.p[0]).concat(s).concat(alt ? ' : ' : '').concat(alt !== null && alt !== void 0 ? alt : '').concat(_markers.p[1]);
  };

  var _opaque = function _opaque(s) {
    return "".concat(_markers.o[0]).concat(s).concat(_markers.o[1]);
  };

  var dcolors = {
    basic: '#a79635',
    name: '#e56a17',
    alert: '#ff2020',
    render: '#1f993f',
    mount: '#cc0096',
    info: '#0070c9',
    data: '#a79635',
    trace: '#1f993f',
    white: '#ffffff',
    bold: '#cc0096',
    boldBg: '#fff3d9',
    colored: '#0f5d9a',
    coloredBg: '#ecffe5',
    attn: '#cc0096',
    attnBg: '#ffbfee',
    _data: '#00b3b0',
    grey: '#cccccc',
    bright: '#ffd580',
    menu: '#00b3b0',
    player: '#0070c9',
    keypoint1: '#008000',
    keypoint2: '#c00000',
    handler: '#8600b3',
    framework: '#e50039',
    maybe: '#ff2020',
    ajaxInit: ['#444', '#8600b3', '#ffdf80'],
    ajaxResponse: ['#444', '#8600b3', '#DAFFCC'],
    ajaxError: ['#c00000', '#8600b3', '#ff9999'] // ajaxBg1: '#ffdf80',
    // ajaxBg2: '#DAFFCC',
    // ajaxBg3: '#ff9999',
    // ajaxColor1: '#444',
    // ajaxColor2: '#000'

  };
  var arrowSymbol = ' ' + _colored('⇢') + ' ';
  var chevronSymbol = ' ' + _bold('»') + ' '; // ' » ';

  var compactKeysCount = 6;

  function logLevel() {
    var newLevel = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

    if (newLevel) {
      if (_.includes(['short', 1], newLevel)) config.level = 1;else if (_.includes(['default', 'normal', 2], newLevel)) config.level = 2;else if (_.includes(['verbose', 'full', 3], newLevel)) config.level = 3;else if (_.includes(['none', 0], newLevel)) config.level = 0;
    }

    return config.level;
  }

  function canIlog(message) {
    var isData = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var permission = /level defaults|ready\(\)/ig.test(message) && config.level == 1 ? false : true;
    permission = isData ? config.level < 3 ? false : true : permission;
    return config.level == 0 ? false : permission;
  }

  function maybeForce(message) {
    return _.endsWith(message, '!') || _.endsWith(message, '?');
  }
  /* eslint-disable no-console */


  function logMaybeNode(node) {
    if (_.isFunction(node)) return;
    var cloned = cloneValue(node);
    node instanceof Node ? console.dirxml(node) : node instanceof Error ? console.log(node) : console.dir(cloned);
  }

  function logWithColors(messages, messageColors) {
    var _messages = _slicedToArray(messages, 3),
        message1 = _messages[0],
        _messages$ = _messages[1],
        message2 = _messages$ === void 0 ? '' : _messages$,
        _messages$2 = _messages[2],
        message3 = _messages$2 === void 0 ? '' : _messages$2;

    var _messageColors = _slicedToArray(messageColors, 3),
        color1 = _messageColors[0],
        _messageColors$ = _messageColors[1],
        color2 = _messageColors$ === void 0 ? '' : _messageColors$,
        _messageColors$2 = _messageColors[2],
        background = _messageColors$2 === void 0 ? null : _messageColors$2;

    var func = config.colors.info ? console.info : console.log;
    var groupFunc = false; // if starts with '>' - then make it as collapsed group

    if (message1.startsWith('>')) {
      message1 = message1.replace(/^>/, '');
      func = console.groupCollapsed;
      groupFunc = true;
    }

    if (message1.startsWith('?')) color1 = dcolors.maybe;
    if (message1.startsWith('!')) color1 = /application|framework/ig.test(message1) ? dcolors.framework : dcolors.attn; // special colors for selected messages

    if (message1.startsWith('#')) {
      background = dcolors.framework;
      color2 = dcolors.bright;
      color1 = dcolors.white;
    } // if var color is the same as the message color


    if (config.colors.same) color2 = color1;
    var colors1 = background ? "font-weight: normal; padding: 3px 0 3px 3px; background: ".concat(background, "; color: ").concat(color1) : "font-weight: normal; color: ".concat(color1);
    var colors2 = background ? "font-weight: bold; padding: 3px 0 3px 3px; background: ".concat(background, "; color: ").concat(color2) : "font-weight: bold; color: ".concat(color2);
    var colors3 = background ? "font-weight: normal; padding: 3px 10px 3px 0; background: ".concat(background, "; color: ").concat(color1) : "font-weight: normal; color: ".concat(color1);
    message1 = background ? message1.trim() : message1;
    message2 = background ? message2.trim() : message2;
    message3 = background ? message3.trim() : message3; // if starts with '!' - then make it BOLD and change console function

    if (message1.startsWith('!')) {
      message1 = message1.replace(/^!/, '');
      colors1 = colors1.replace('normal', 'bold');
      colors3 = colors3.replace('normal', 'bold');
      func = groupFunc ? console.groupCollapsed : console.info;
    } // if starts with '?' - then make it BOLD


    if (message1.startsWith('?')) {
      message1 = message1.replace(/^\?/, '');
      colors1 = colors1.replace('normal', 'bold');
      colors3 = colors3.replace('normal', 'bold');
    } // if starts with '#' - then make it BOLD


    if (message1.startsWith('#')) {
      message1 = message1.replace(/^#/, ' ★★★ ').replace(/[.]+$/, '');
      colors1 = colors1.replace('normal', 'bold');
      colors3 = colors3.replace('normal', 'bold');
      if (!message2) message1 += ' ★★★ ';else if (message3) message3 += ' ★★★ ';
    }

    for (var _len = arguments.length, data = new Array(_len > 2 ? _len - 2 : 0), _key2 = 2; _key2 < _len; _key2++) {
      data[_key2 - 2] = arguments[_key2];
    }

    var firstData = data[0],
        rest = data.slice(1);

    if (config.mods.forseNil || firstData !== undefined) {
      if (config.mods.consoleDir) {
        var _console;

        if (message2 && color2) func('%c%s%c%s%c%s%c', colors1, message1, colors2, message2, colors1, message3, background ? colors3 : '');else func('%c%s ', colors1, message1);

        (_console = console).dir.apply(_console, [firstData].concat(_toConsumableArray(rest)));
      } else {
        if (message2 && color2) func.apply(void 0, ['%c%s%c%s%c%s%c', colors1, message1, colors2, message2, colors1, message3, background ? colors3 : '', firstData].concat(_toConsumableArray(rest)));else func.apply(void 0, ['%c%s ', colors1, message1, firstData].concat(_toConsumableArray(rest)));
      }
    } else {
      if (message2 && color2) func('%c%s%c%s%c%s%c', colors1, message1, colors2, message2, colors1, message3, background ? colors3 : '');else func('%c%s ', colors1, message1);
    } // reset all modifiers


    config.colors = _.mapValues(config.colors, function () {
      return false;
    });
    config.mods = _.mapValues(config.mods, function () {
      return false;
    });
  }

  function logWithColors2(message) {
    var func = config.colors.info ? console.info : console.log;
    var colors = getColors(colorBy(message));

    var _parseWithColors = parseWithColors(message, colors),
        format = _parseWithColors.format,
        items = _parseWithColors.items;

    for (var _len2 = arguments.length, data = new Array(_len2 > 1 ? _len2 - 1 : 0), _key3 = 1; _key3 < _len2; _key3++) {
      data[_key3 - 1] = arguments[_key3];
    }

    if (!_.isEmpty(data)) format = format + '  ';

    _.forEach(data, function (item) {
      if (_.isString(item)) {
        var _parseWithColors2 = parseWithColors(item, colors),
            newFormat = _parseWithColors2.format,
            newItems = _parseWithColors2.items;

        format = format + newFormat;
        items.push.apply(items, _toConsumableArray(newItems));
      } else {
        format = format + '%o';
        items.push(item);
      }
    });

    func.apply(void 0, [format].concat(_toConsumableArray(items)));
    config.colors = _.mapValues(config.colors, function () {
      return false;
    });
  }

  function log(message) {
    if (!canIlog(message)) return;
    var loglevel = logLevel();
    if (loglevel == 0) return;

    if (message) {
      message = message.trim();
      var colors = [colorBy(message), dcolors.name, null];
      var param_regex = /\[\s*([^\]]+)]/i; // let color2 = /loading =|ver /ig.test(message) ? dcolors.navigate : dcolors.name;

      for (var _len3 = arguments.length, data = new Array(_len3 > 1 ? _len3 - 1 : 0), _key4 = 1; _key4 < _len3; _key4++) {
        data[_key4 - 1] = arguments[_key4];
      }

      if (param_regex.test(message)) {
        var matches = param_regex.exec(message);
        if (/ajax\s*\w*\s*request/ig.test(message)) colors = dcolors.ajaxInit;else if (/ajax\s*\w*\s*response/ig.test(message)) colors = dcolors.ajaxResponse;else if (/ajax\s*\w*\s*error/ig.test(message)) colors = dcolors.ajaxError;
        var messages = [message.replace(matches[0], '[ '), matches[1], ' ]'];
        logWithColors.apply(void 0, [messages, colors].concat(data));
      } else {
        logWithColors.apply(void 0, [[message], colors].concat(data));
      }
    }
  }

  function logVerbose(message, data, more) {
    if (logLevel() === 3) log(message, data, more);
  }

  function logGroup(obj) {
    var groupName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
    var withoutNil = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    var verboseOnly = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

    if (verboseOnly && logLevel() < 2) {
      console.groupEnd();
      return;
    }

    var closeMore = false;

    if (groupName && _.isPlainObject(obj)) {
      console.groupCollapsed('%c%s', "font-weight: bold; color: ".concat(dcolors.name, "; padding: 3px;"), groupName.trim());
      closeMore = true;
    }

    for (var key in obj) {
      if (withoutNil && _.isNil(obj[key])) continue; // › »

      var keyName = groupName && _.isArray(obj) ? "".concat(groupName, "[").concat(key, "]") : key;

      if (_.isFunction(obj[key])) {
        console.dir(obj);
        break;
      } else console.log('%c%s%c ⇢ %o', "font-weight: bold; color: ".concat(dcolors.name), keyName, "font-weight: normal; color: ".concat(dcolors.navigate), obj[key]);
    }

    console.groupEnd();
    if (closeMore) console.groupEnd(); // reset all modifiers

    config.colors = _.mapValues(config.colors, function () {
      return false;
    });
    config.mods = _.mapValues(config.mods, function () {
      return false;
    });
  }

  function logExpanded() {
    var _console2;

    (_console2 = console).dir.apply(_console2, arguments);
  }

  function logColapsed() {
    var _console3;

    (_console3 = console).log.apply(_console3, arguments);
  }

  function logSmart(value, len) {
    var length = len !== null && len !== void 0 ? len : _.keys(value).length;
    if (length < compactKeysCount) logColapsed(value);else logExpanded(value);
  }

  function warn(message, data, more) {
    if (logLevel() == 0) return;
    if (!canIlog(message)) return;

    if (message) {
      console.warn(message.replace(/^[!|?]/, ''));
      if (data && maybeForce(message) && logLevel() == 1) logMaybeNode(data);
    }

    if (!_.isUndefined(data) && canIlog(message, true)) logMaybeNode(data);
    if (!_.isUndefined(more) && canIlog(message, true)) logMaybeNode(more);

    if (canIlog(message, true)) {
      console.trace();
    }
  }

  function error(message, data) {
    // ignore errors when requested
    if (config.mods.ignoreNext) return;
    if (_.isUndefined(data)) console.error(message);else {
      console.error(message);
      console.info('Error data:', data);
    }
  } // log ajax request and its options


  function logRequestResponse(type, route, options, response) {
    var method = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 'GET';
    var messages = {
      request: " \xAB\xAB Initiating Ajax ".concat(method, " request with route [").concat(route, "]"),
      error: " \xBB\xBB Ajax ".concat(method, " error received from [").concat(route, "]"),
      response: " \xBB\xBB Ajax ".concat(method, " response received from [").concat(route, "]")
    };
    var message = _.get(messages, type) || "? Ajax ".concat(type);
    var logData = response ? response : options;

    if (response) {
      logData = _.merge(logData, {
        timestamp: new Date().toString()
      });

      if (_.isEmpty(response)) {
        message += " : response is empty ";
      }
    } // Log request URL and its data (options or response) if presented


    if (_.isEmpty(logData)) {
      log(message);
    } else {
      log(">".concat(message));
      logGroup(logData);
    } // start/stop timing if was set in defaults
  }

  function logAsOneString(chunks) {
    var message = _.isArray(chunks) ? _.join(chunks, ' ') : String(chunks);

    for (var _len4 = arguments.length, data = new Array(_len4 > 1 ? _len4 - 1 : 0), _key5 = 1; _key5 < _len4; _key5++) {
      data[_key5 - 1] = arguments[_key5];
    }

    logWithColors2.apply(void 0, [message.replace(/\s+/g, ' ').replace(/\s*\]/g, ']').replace(/\[\s*/g, '[')].concat(data));
  }
  /* eslint-enable no-console */
  // Debugging in components ----------------------------------------------------]
  // just display the label every time the component is rendered


  function renderComponent(maybeClientId) {
    var _$castArray = _.castArray(maybeClientId),
        _$castArray2 = _slicedToArray(_$castArray, 2),
        clientId = _$castArray2[0],
        clientId2 = _$castArray2[1];

    var component = componentName(clientId2 ? 'renderComponentWithId,renderComponent' : 'renderComponent');
    var id = (clientId !== null && clientId !== void 0 ? clientId : clientId2) ? " with ".concat(_bold(shortenId(clientId !== null && clientId !== void 0 ? clientId : clientId2))) : '';
    config.colors.render = true;
    setOpaqueColors('green');
    logAsOneString("".concat(_bold(component)).concat(id, " ").concat(_opaque('render')));
  } // display variables and their values, possibly simplifying the data


  function dataInComponent(data) {
    var marker = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var component = componentName('dataInComponent');

    var keys = _.keys(data);

    var isSingleKey = keys.length === 1;
    var key = isSingleKey ? _.first(keys) : _.join(_.map(keys, _accented), ", ");
    var value = isSingleKey ? data[key] : data;
    var altName = marker ? ":".concat(_colored(String(marker))) : '';
    var message = "".concat(_bold(component)).concat(altName, " ").concat(arrowSymbol, " value for ").concat(isSingleKey ? _accented(key) : key);
    config.colors.data = true;

    if (isSimpleType(value)) {
      logAsOneString(message, value);
    } else {
      logAsOneString(message);
      logSimplified(value);
    }
  } // display a formatted string and possibly some data


  function infoInComponent(messageData) {
    var _$castArray3 = _.castArray(messageData),
        _$castArray4 = _slicedToArray(_$castArray3, 2),
        message = _$castArray4[0],
        clientId = _$castArray4[1];

    var id = clientId ? " with ".concat(_bold(shortenId(clientId))) : '';
    var component = componentName(clientId ? 'infoInComponentWithId,infoInComponent' : 'infoInComponent');
    var info = "".concat(_bold(component)).concat(id, " ").concat(arrowSymbol, " ").concat(message);
    config.colors.info = true;
    setOpaqueColors('blue');

    for (var _len5 = arguments.length, data = new Array(_len5 > 1 ? _len5 - 1 : 0), _key6 = 1; _key6 < _len5; _key6++) {
      data[_key6 - 1] = arguments[_key6];
    }

    if (data.length === 0 || data.length === 1 && isCompactType(data[0])) {
      logAsOneString.apply(void 0, [info].concat(data));
    } else {
      logAsOneString(info);
      logExpanded.apply(void 0, data);
    }
  } // trace changes in component props and state


  function useTraceUpdate(props) {
    var state = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    var trackClientId = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    var ref = useRef({
      key: componentName(trackClientId ? 'useTraceUpdate,useTraceUpdateWithId' : 'useTraceUpdate'),
      id: trackClientId ? " with ".concat(_bold(shortenId(props))) : ''
    });
    var prevProps = usePrevious(props);
    var prevState = usePrevious(state);
    useEffect(function () {
      var _ref$current;

      var _ref = (_ref$current = ref.current) !== null && _ref$current !== void 0 ? _ref$current : {},
          id = _ref.id,
          key = _ref.key;

      var propKeys = changedKeys(props, prevProps);
      var stateKeys = changedKeys(state, prevState);
      var propsChanged = propKeys[0].length || propKeys[1] || propKeys[2];
      var stateChanged = stateKeys[0].length || stateKeys[1] || stateKeys[2];
      if (propsChanged && !stateChanged) logAsOneString("Traced changes".concat(id, " ").concat(_param(key, 'props')));
      if (!propsChanged && stateChanged) logAsOneString("Traced changes".concat(id, " ").concat(_param(key, 'state')));
      if (propsChanged && stateChanged) logAsOneString("Traced changes".concat(id, " ").concat(_param(key, 'props & state')));
      if (propsChanged) logChanges(propKeys, prevProps, props);
      if (stateChanged) logChanges(stateKeys, prevState, state);
    }, [props, prevProps, state, prevState]);
  } // to log 'aka' Mounting and Unmounting events


  function useMountUnmount() {
    var ref = useRef({
      component: componentName('useMountUnmount')
    });
    useEffect(function () {
      var _ref$current2;

      var _ref2 = (_ref$current2 = ref.current) !== null && _ref$current2 !== void 0 ? _ref$current2 : {},
          component = _ref2.component;

      config.colors.mount = true;
      logAsOneString("".concat(_bold(component), " ").concat(arrowSymbol, " ").concat(_colored('componentDidMount')));
      return function () {
        config.colors.mount = true;
        logAsOneString("".concat(_bold(component), " ").concat(arrowSymbol, " ").concat(_opaque('componentWillUnmount$')));
      };
    }, []);
  } // to trace several instances of one component on the page --------------------]


  function useTraceUpdateWithId(props) {
    var state = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    useTraceUpdate(props, state, true);
  }

  function infoInComponentWithId(clientId, message) {
    for (var _len6 = arguments.length, data = new Array(_len6 > 2 ? _len6 - 2 : 0), _key7 = 2; _key7 < _len6; _key7++) {
      data[_key7 - 2] = arguments[_key7];
    }

    infoInComponent.apply(void 0, [[message, clientId]].concat(data));
  }

  function renderComponentWithId(clientId) {
    renderComponent(clientId);
  } // Helpers for colored console & components debuging --------------------------]


  function colorBy(message) {
    var color = dcolors.basic; // first test with var names

    if (config.colors.info) return dcolors.info;
    if (config.colors.data) return dcolors.data;
    if (config.colors.trace) return dcolors.trace;
    if (config.colors.render) return dcolors.render;
    if (config.colors.alert) return dcolors.alert;
    if (config.colors.mount) return dcolors.mount; // remove any var names which may lead to false-positive test

    message = message.replace(/\[[^\]]+\]/, '').replace(/"[^"]+"/g, '');
    if (/token|logout|user/ig.test(message)) return /unsuccessful|error/ig.test(message) ? dcolors.keypoint2 : dcolors.keypoint1;
    if (/unsuccessfully|preloading/ig.test(message)) return dcolors.basic;
    if (/loading|launching|ajax/ig.test(message)) return dcolors.framework;
    return color;
  }

  function getColors() {
    var mainColor = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : dcolors.basic;
    var weightNormal = 'font-weight: normal;';
    var weightBold = 'font-weight: bold;';
    var padding = 'padding: 0 2px 0 2px;';
    var paddingBg = 'padding: 1px 3px 1px 3px;';
    var rounded = 'border-radius: 3px;';
    var opaque = config.colors.opaque || {
      color: dcolors.white,
      bg: dcolors.alert
    };
    return {
      normal: "".concat(weightNormal, " color: ").concat(mainColor),
      accent: "".concat(weightBold, " ").concat(paddingBg, " ").concat(rounded, " color: ").concat(dcolors.bold, "; background: ").concat(dcolors.boldBg),
      bold: "".concat(weightBold, " color: ").concat(mainColor),
      params: "".concat(weightBold, " ").concat(padding, " color: ").concat(dcolors.name),
      colored: "".concat(weightBold, " ").concat(paddingBg, " ").concat(rounded, " color: ").concat(dcolors.colored, "; background: ").concat(dcolors.coloredBg),
      opaque: "".concat(weightBold, " ").concat(paddingBg, " ").concat(rounded, " color: ").concat(opaque.color, "; background: ").concat(opaque.bg)
    };
  }

  function setOpaqueColors(color) {
    if (color === 'green') config.colors.opaque = {
      color: dcolors.white,
      bg: dcolors.render
    };
    if (color === 'red') config.colors.opaque = {
      color: dcolors.white,
      bg: dcolors.alert
    };
    if (color === 'violet') config.colors.opaque = {
      color: dcolors.white,
      bg: dcolors.mount
    };
    if (color === 'orange') config.colors.opaque = {
      color: dcolors.white,
      bg: dcolors.name
    };
    if (color === 'blue') config.colors.opaque = {
      color: dcolors.white,
      bg: dcolors.info
    };
  } // старая реализация через regex, сохранил тут для идей
  // const fixed = { '*':'#1','_':'#2','~':'#3','{':'#4','}':'#5' };
  // const fixed = { '*':'#1','_':'#2' };
  // const inverted = _.invert(fixed);
  // replace the characters that will be used for formatting (then we will restore them)
  // const safe = s => s.replace(/[*_]/g, m => fixed[m]); // /[*_~{}]/g
  // const restore = s => s.replace(/(#1|#2)/g, m => inverted[m]); // /(#1|#2|#3|#4|#5)/g


  var tokenFormat = function tokenFormat(t) {
    return "".concat(t, "%c");
  };

  function parseWithColors(message, colors) {
    var _ref3 = colors !== null && colors !== void 0 ? colors : getColors(),
        normal = _ref3.normal,
        bold = _ref3.bold,
        params = _ref3.params,
        accent = _ref3.accent,
        colored = _ref3.colored,
        opaque = _ref3.opaque;

    var a = _markers.a,
        b = _markers.b,
        c = _markers.c,
        p = _markers.p,
        o = _markers.o;
    var isComplete = true;
    var format = '%c';
    var items = [normal];
    var token = ''; // ±text± as 'accented'
    // §text§ as 'bold'
    // ~text~ as 'colored'
    // [text] as 'param'
    // {text} as 'opaque'

    _.forEach(message, function (char) {
      if (char === a) {
        if (isComplete) {
          format += tokenFormat(token);
          items.push(accent);
          token = '';
          isComplete = false;
        } else {
          format += tokenFormat(token);
          items.push(normal);
          token = '';
          isComplete = true;
        }
      } else if (char === c) {
        if (isComplete) {
          format += tokenFormat(token);
          items.push(colored);
          token = '';
          isComplete = false;
        } else {
          format += tokenFormat(token);
          items.push(normal);
          token = '';
          isComplete = true;
        }
      } else if (char === b) {
        if (isComplete) {
          format += tokenFormat(token);
          items.push(bold);
          token = '';
          isComplete = false;
        } else {
          format += tokenFormat(token);
          items.push(normal);
          token = '';
          isComplete = true;
        }
      } else if (char === p[0]) {
        format += tokenFormat(token + p[0]); // `${token}${p[0]}%c`

        items.push(params);
        token = '';
      } else if (char === p[1]) {
        format += tokenFormat(token);
        items.push(normal);
        token = p[1];
      } else if (char === o[0]) {
        format += tokenFormat(token);
        items.push(opaque);
        token = '';
      } else if (char === o[1]) {
        format += tokenFormat(token);
        items.push(normal);
        token = '';
      } else {
        token += char;
      }
    });

    format += token;
    return {
      format: format,
      items: items
    };
  }

  function isSimpleType(val) {
    return _.isNil(val) || _.isBoolean(val) || _.isString(val) || _.isNumber(val);
  }

  function isCompactType(val) {
    return isSimpleType(val) || _.isObject(val) && _.keys(val).length < compactKeysCount;
  }

  function changedKeys(next, prev) {
    var updated = [];

    _.forEach(next, function (val, key) {
      if (prev && prev[key] !== val) {
        updated.push(key);
      }
    });

    var nextKeys = _.keys(next);

    var prevKeys = _.keys(prev);

    var added = _.difference(nextKeys, prevKeys);

    var removed = _.difference(prevKeys, nextKeys); // 'added' keys will also be included in 'updated', so we exclude them


    return [_.difference(updated, added), _.isEmpty(added) ? null : added, _.isEmpty(removed) ? null : removed];
  }

  function shortenId(props) {
    var forStorage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var shortened = props && props.clientId ? props.clientId.slice(-4) : 0;
    return forStorage ? shortened : shortened === 0 ? '?' : "\u2737\u2737\u2737-".concat(shortened);
  }

  function cloneValue(value) {
    // do nothing for null & undefined
    if (_.isNil(value)) return value; // first try with lodash 'cloneDeepWith'

    var nodeCloner = function nodeCloner(value) {
      return _.isElement(value) ? value.cloneNode(true) : undefined;
    };

    var cloned = _.cloneDeepWith(value, nodeCloner);

    if (!_.isEmpty(cloned)) return cloned; // try with JSON if 'cloneDeepWith' failed

    var seen = new WeakSet();

    var circularReplacer = function circularReplacer(_key, value) {
      if (_typeof(value) === 'object' && value !== null) {
        if (seen.has(value)) return;
        seen.add(value);
      }

      return _.isUndefined(value) ? '__undefined' : value;
    };

    return JSON.parse(JSON.stringify(value, circularReplacer));
  }

  function logSimplified(val) {
    {
      var keys = _.keys(val);

      var firstKey = _.first(keys);

      var value = keys.length === 1 ? val[firstKey] : val;

      if (keys.length === 1) {
        var kind = _.isArray(val) ? "at ".concat(_accented('index')) : "for ".concat(_accented('key'));
        var message = "value ".concat(kind, " ").concat(_param(firstKey));

        if (isSimpleType(value)) {
          logAsOneString(message, value);
        } else {
          logAsOneString(message);
          logSimplified(value);
        }
      } else {
        logSmart(val, keys.length);
      }
    }
  }

  function logAddedRemoved(added, removed) {
    var addedKeys = added ? added.length > 1 ? 'keys' : 'key' : false;
    var removedKeys = removed ? removed.length > 1 ? 'keys' : 'key' : false;
    var message = addedKeys || removedKeys ? chevronSymbol : '';

    if (addedKeys) {
      var keys = added.length > compactKeysCount ? _.concat(_.take(added, compactKeysCount), ['and more...']) : added;
      message += "added ".concat(_bold(addedKeys), " ").concat(_param(_.join(keys, ', '))).concat(removedKeys ? ', ' : '');
    }

    if (removedKeys) {
      var _keys = removed.length > compactKeysCount ? _.concat(_.take(removed, compactKeysCount), ['and more...']) : removed;

      message += "removed ".concat(_bold(removedKeys), " ").concat(_param(_.join(_keys, ', ')));
    }

    if (message) logAsOneString(message);
  }

  function logWasNow(was, now, keys) {
    var firstKey = _.first(keys);

    var wasValue = keys.length === 1 ? was[firstKey] : was;
    var nowValue = keys.length === 1 ? now[firstKey] : now;

    var _ref4 = keys.length === 1 ? changedKeys(nowValue, wasValue) : [],
        _ref5 = _slicedToArray(_ref4, 3),
        updated = _ref5[0],
        added = _ref5[1],
        removed = _ref5[2];

    var changed = keys.length === 1 ? updated !== null && updated !== void 0 ? updated : [] : false;
    logAddedRemoved(added, removed);

    if (changed && changed.length === 1) {
      var firstСhanged = _.first(changed);

      var message = "".concat(chevronSymbol, "changed for ").concat(_bold('key'), " ").concat(_param(firstСhanged));

      if (isSimpleType(nowValue[firstСhanged])) {
        logAsOneString(message, wasValue[firstСhanged], arrowSymbol, nowValue[firstСhanged]);
      } else {
        logAsOneString(message);
        logWasNow(wasValue, nowValue, changed);
      }
    } else {
      logAsOneString("".concat(_colored('was')));
      logSmart(wasValue);
      logAsOneString(changed ? "".concat(_colored('now'), " changed for ").concat(_bold('keys'), " ").concat(_param(_.join(changed, ', '))) : "".concat(_colored('now')));
      logSmart(nowValue);

      if (_.isEqual(wasValue, nowValue)) {
        logAsOneString("".concat(_opaque('Attention!'), " ").concat(_bold('they are equal!')));
      }
    }
  }

  function logChanges(keys, prevValues, values) {
    var _keys2 = _slicedToArray(keys, 3),
        updated = _keys2[0],
        added = _keys2[1],
        removed = _keys2[2]; // maybe there were additions and deletions?


    logAddedRemoved(added, removed);
    if (updated.length === 0) logWasNow(prevValues, values, updated); // log in detail for changes

    _.forEach(updated, function (key) {
      var value = values[key];
      config.colors.trace = true;
      var message = "".concat(chevronSymbol).concat(_accented(key));
      if (isSimpleType(value)) logAsOneString(message, prevValues[key], arrowSymbol, value);else {
        if (_.isFunction(value)) {
          logAsOneString([message, "".concat(_param('function'))]);
        } else {
          var _changedKeys = changedKeys(value, prevValues[key]),
              _changedKeys2 = _slicedToArray(_changedKeys, 3),
              changed = _changedKeys2[0],
              addedKeys = _changedKeys2[1],
              removedKeys = _changedKeys2[2];

          logAddedRemoved(addedKeys, removedKeys);

          var firstKey = _.first(changed);

          if (!changed.length && !(addedKeys !== null && addedKeys !== void 0 && addedKeys.length) && !(removedKeys !== null && removedKeys !== void 0 && removedKeys.length)) {
            logAsOneString("".concat(message, " ").concat(arrowSymbol, " changed itself but the keys unchanged {something is wrong!}"));
            logWasNow(prevValues[key], value, changed);
          } else {
            var keyMsg = "".concat(message, " @1 ").concat(_bold('@2'), " ").concat(_param(_.join(changed, ', ')));

            if (_.isArray(value)) {
              var arrayMsg = keyMsg.replace('@2', changed.length === 1 ? 'index' : 'indexes').replace('@1', 'at');

              if (changed.length === 1 && isSimpleType(value[firstKey])) {
                logAsOneString(arrayMsg, prevValues[key][firstKey], arrowSymbol, value[firstKey]);
              } else {
                logAsOneString(arrayMsg);
                logWasNow(prevValues[key], value, changed);
              }
            } else {
              if (_.has(value, '$$typeof')) {
                logAsOneString([message, "".concat(_param('React Component'))]);
              } else {
                var objMsg = keyMsg.replace('@2', changed.length === 1 ? 'key' : 'keys').replace('@1', 'for');

                if (changed.length === 1 && isSimpleType(value[firstKey])) {
                  logAsOneString(objMsg, prevValues[key][firstKey], arrowSymbol, value[firstKey]);
                } else {
                  logAsOneString(objMsg);
                  logWasNow(_.pick(prevValues[key], changed), _.pick(value, changed), changed);
                }
              }
            }
          }
        }
      }
    });
  } // Get function & component names from stack ----------------------------------]


  function skipFrames(name, prev) {
    var frames = _.isArray(name) ? name.length : _.split(name, ',').length;
    var prevFrames = _.isNumber(prev) ? prev : _.isArray(prev) ? prev.length : _.split(prev, ',').length;
    return prevFrames + frames;
  }

  function componentName() {
    var prevFrames = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;

    var _findOnStack = findOnStack(skipFrames('componentName', prevFrames)),
        _findOnStack2 = _slicedToArray(_findOnStack, 1),
        name = _findOnStack2[0]; // component name should start with UpperCase


    if (name[0] === name[0].toUpperCase()) return name; // maybe we have function?

    var func = name.replace('/zu_blocks', '').replace(/[/]/g, '.');
    return "".concat(func, "()");
  }

  function findOnStack(prevFrames) {
    var removeFrames = skipFrames('findOnStack', prevFrames);

    var stack = _.slice(_.split(new Error().stack, '\n'), removeFrames, removeFrames + 2);

    return [funcFromStack(stack, 0), funcFromStack(stack, 1)];
  }

  function funcFromStack(frames) {
    var index = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
    // logColapsed(frames[0]);
    return (_.get(_.split(frames[index], '@'), 0, '?') || '?').replace(/[<|/]+$/g, '');
  }

  var debug = {
    get ver() {
      return config.version;
    },

    get level() {
      return logLevel();
    },

    set level(val) {
      logLevel(val);
    },

    set ignoreNext(val) {
      config.mods.ignoreNext = val;
    },

    log: log,
    logVerbose: logVerbose,
    logGroup: logGroup,
    warn: warn,
    error: error,
    render: renderComponent,
    data: dataInComponent,
    info: infoInComponent,
    useTrace: useTraceUpdate,
    useMU: useMountUnmount,
    useTraceWithId: useTraceUpdateWithId,
    renderWithId: renderComponentWithId,
    infoWithId: infoInComponentWithId,
    request: function request(route, options, method) {
      logRequestResponse('request', route, options, null, method);
    },
    response: function response(route, data, method) {
      logRequestResponse('response', route, null, data, method);
    },
    requestError: function requestError(route, error, method) {
      logRequestResponse('error', route, null, error, method);
    }
  };

  wp.zukit = {
    render: render$1,
    fetch: fetch,
    utils: utils,
    jq: jq,
    icons: icons,
    components: components,
    debug: debug
  };

})();
//# sourceMappingURL=zukit.min.js.map
